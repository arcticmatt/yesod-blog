<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css"></link><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-2" name="line-2"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-3" name="line-3"></a><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-4" name="line-4"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-5" name="line-5"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-6" name="line-6"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Foundation</span><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-7" name="line-7"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-8" name="line-8"></a><span class="hs-keyword">import</span><span> </span><a href="../MyBlog-0.0.0/Import.NoFoundation.html"><span class="hs-identifier">Import</span><span class="hs-operator">.</span><span class="hs-identifier">NoFoundation</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-9" name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Persist</span><span class="hs-operator">.</span><span class="hs-identifier">Sql</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ConnectionPool</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">runSqlPool</span><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-10" name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Hamlet</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hamletFile</span><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-11" name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Jasmine</span><span>         </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minifym</span><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-12" name="line-12"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-13" name="line-13"></a><span class="hs-comment">-- Used only when in &quot;auth-dummy-login&quot; setting is enabled.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-14" name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Auth</span><span class="hs-operator">.</span><span class="hs-identifier">Dummy</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-15" name="line-15"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-16" name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Auth</span><span class="hs-operator">.</span><span class="hs-identifier">OpenId</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">authOpenId</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">IdentifierType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Claimed</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-17" name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Default</span><span class="hs-operator">.</span><span class="hs-identifier">Util</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">addStaticContentExternal</span><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-18" name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Logger</span><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-19" name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Unsafe</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Unsafe</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-20" name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">CaseInsensitive</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CI</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-21" name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Encoding</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TE</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-22" name="line-22"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-23" name="line-23"></a><span class="hs-comment">-- | The foundation datatype for your application. This can be a good place to</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-24" name="line-24"></a><span class="hs-comment">-- keep settings and values requiring initialization before your application</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-25" name="line-25"></a><span class="hs-comment">-- starts running, such as database connections. Every handler will have</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-26" name="line-26"></a><span class="hs-comment">-- access to the data present here.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-27" name="line-27"></a><span class="hs-keyword">data</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#App" name="App"><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier">App</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#App" name="App"><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier">App</span></a></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-28" name="line-28"></a><span>    </span><span class="hs-special">{</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#appSettings" name="appSettings"><a href="../MyBlog-0.0.0/Foundation.html#appSettings"><span class="hs-identifier">appSettings</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="../MyBlog-0.0.0/Settings.html#AppSettings"><span class="hs-identifier hs-type">AppSettings</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-29" name="line-29"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#appStatic" name="appStatic"><a href="../MyBlog-0.0.0/Foundation.html#appStatic"><span class="hs-identifier">appStatic</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Static</span><span> </span><span class="hs-comment">-- ^ Settings for static file serving.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-30" name="line-30"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#appConnPool" name="appConnPool"><a href="../MyBlog-0.0.0/Foundation.html#appConnPool"><span class="hs-identifier">appConnPool</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ConnectionPool</span><span> </span><span class="hs-comment">-- ^ Database connection pool.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-31" name="line-31"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#appHttpManager" name="appHttpManager"><a href="../MyBlog-0.0.0/Foundation.html#appHttpManager"><span class="hs-identifier">appHttpManager</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Manager</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-32" name="line-32"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#appLogger" name="appLogger"><a href="../MyBlog-0.0.0/Foundation.html#appLogger"><span class="hs-identifier">appLogger</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Logger</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-33" name="line-33"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-34" name="line-34"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-35" name="line-35"></a><span class="hs-keyword">data</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#MenuItem" name="MenuItem"><a href="../MyBlog-0.0.0/Foundation.html#MenuItem"><span class="hs-identifier">MenuItem</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#MenuItem" name="MenuItem"><a href="../MyBlog-0.0.0/Foundation.html#MenuItem"><span class="hs-identifier">MenuItem</span></a></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-36" name="line-36"></a><span>    </span><span class="hs-special">{</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#menuItemLabel" name="menuItemLabel"><a href="../MyBlog-0.0.0/Foundation.html#menuItemLabel"><span class="hs-identifier">menuItemLabel</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-37" name="line-37"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#menuItemRoute" name="menuItemRoute"><a href="../MyBlog-0.0.0/Foundation.html#menuItemRoute"><span class="hs-identifier">menuItemRoute</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Route</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier hs-type">App</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-38" name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#menuItemAccessCallback" name="menuItemAccessCallback"><a href="../MyBlog-0.0.0/Foundation.html#menuItemAccessCallback"><span class="hs-identifier">menuItemAccessCallback</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-39" name="line-39"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-40" name="line-40"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-41" name="line-41"></a><span class="hs-keyword">data</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#MenuTypes" name="MenuTypes"><a href="../MyBlog-0.0.0/Foundation.html#MenuTypes"><span class="hs-identifier">MenuTypes</span></a></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-42" name="line-42"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#NavbarLeft" name="NavbarLeft"><a href="../MyBlog-0.0.0/Foundation.html#NavbarLeft"><span class="hs-identifier">NavbarLeft</span></a></a><span> </span><a href="../MyBlog-0.0.0/Foundation.html#MenuItem"><span class="hs-identifier hs-type">MenuItem</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-43" name="line-43"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#NavbarRight" name="NavbarRight"><a href="../MyBlog-0.0.0/Foundation.html#NavbarRight"><span class="hs-identifier">NavbarRight</span></a></a><span> </span><a href="../MyBlog-0.0.0/Foundation.html#MenuItem"><span class="hs-identifier hs-type">MenuItem</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-44" name="line-44"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-45" name="line-45"></a><span class="hs-comment">-- This is where we define all of the routes in our application. For a full</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-46" name="line-46"></a><span class="hs-comment">-- explanation of the syntax, please see:</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-47" name="line-47"></a><span class="hs-comment">-- http://www.yesodweb.com/book/routing-and-handlers</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-48" name="line-48"></a><span class="hs-comment">--</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-49" name="line-49"></a><span class="hs-comment">-- Note that this is really half the story; in Application.hs, mkYesodDispatch</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-50" name="line-50"></a><span class="hs-comment">-- generates the rest of the code. Please see the following documentation</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-51" name="line-51"></a><span class="hs-comment">-- for an explanation for this split:</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-52" name="line-52"></a><span class="hs-comment">-- http://www.yesodweb.com/book/scaffolding-and-the-site-template#scaffolding-and-the-site-template_foundation_and_application_modules</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-53" name="line-53"></a><span class="hs-comment">--</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-54" name="line-54"></a><span class="hs-comment">-- This function also generates the following type synonyms:</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-55" name="line-55"></a><span class="hs-comment">-- type Handler = HandlerT App IO</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-56" name="line-56"></a><span class="hs-comment">-- type Widget = WidgetT App IO ()</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-57" name="line-57"></a><span class="hs-identifier hs-var">mkYesodData</span><span> </span><span class="hs-string">&quot;App&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span class="hs-special">(</span><span class="hs-identifier hs-var">parseRoutesFile</span><span> </span><span class="hs-string">&quot;config/routes&quot;</span><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-58" name="line-58"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-59" name="line-59"></a><span class="hs-comment">-- | A convenient synonym for creating forms.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-60" name="line-60"></a><span class="hs-keyword">type</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#Form" name="Form"><a href="../MyBlog-0.0.0/Foundation.html#Form"><span class="hs-identifier">Form</span></a></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679443983" name="local-6989586621679443983"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679443983"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Html</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">MForm</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerT</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier hs-type">App</span></a><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FormResult</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679443983"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#Widget"><span class="hs-identifier hs-type">Widget</span></a><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-61" name="line-61"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-62" name="line-62"></a><span class="hs-comment">-- Please see the documentation for the Yesod typeclass. There are a number</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-63" name="line-63"></a><span class="hs-comment">-- of settings which can be configured by overriding methods here.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-64" name="line-64"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Yesod</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier hs-type">App</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-65" name="line-65"></a><span>    </span><span class="hs-comment">-- Controls the base of generated URLs. For more information on modifying,</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-66" name="line-66"></a><span>    </span><span class="hs-comment">-- see: https://github.com/yesodweb/yesod/wiki/Overriding-approot</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-67" name="line-67"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323798732" name="local-8214565720323798732"><span class="hs-identifier">approot</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ApprootRequest</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445896" name="local-6989586621679445896"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445896"><span class="hs-identifier">app</span></a></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445897" name="local-6989586621679445897"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445897"><span class="hs-identifier">req</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-68" name="line-68"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">appRoot</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">appSettings</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445896"><span class="hs-identifier hs-var">app</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-69" name="line-69"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">getApprootText</span><span> </span><span class="hs-identifier hs-var">guessApproot</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445896"><span class="hs-identifier hs-var">app</span></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445897"><span class="hs-identifier hs-var">req</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-70" name="line-70"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445898" name="local-6989586621679445898"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445898"><span class="hs-identifier">root</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445898"><span class="hs-identifier hs-var">root</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-71" name="line-71"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-72" name="line-72"></a><span>    </span><span class="hs-comment">-- Store session data on the client in encrypted cookies,</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-73" name="line-73"></a><span>    </span><span class="hs-comment">-- default session idle timeout is 120 minutes</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-74" name="line-74"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323798719" name="local-8214565720323798719"><span class="hs-identifier">makeSessionBackend</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">defaultClientSessionBackend</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-75" name="line-75"></a><span>        </span><span class="hs-number">120</span><span>    </span><span class="hs-comment">-- timeout in minutes</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-76" name="line-76"></a><span>        </span><span class="hs-string">&quot;config/client_session_key.aes&quot;</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-77" name="line-77"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-78" name="line-78"></a><span>    </span><span class="hs-comment">-- Yesod Middleware allows you to run code before and after each handler function.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-79" name="line-79"></a><span>    </span><span class="hs-comment">-- The defaultYesodMiddleware adds the response header &quot;Vary: Accept, Accept-Language&quot; and performs authorization checks.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-80" name="line-80"></a><span>    </span><span class="hs-comment">-- Some users may also want to add the defaultCsrfMiddleware, which:</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-81" name="line-81"></a><span>    </span><span class="hs-comment">--   a) Sets a cookie with a CSRF token in it.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-82" name="line-82"></a><span>    </span><span class="hs-comment">--   b) Validates that incoming write requests include that token in either a header or POST parameter.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-83" name="line-83"></a><span>    </span><span class="hs-comment">-- To add it, chain it together with the defaultMiddleware: yesodMiddleware = defaultYesodMiddleware . defaultCsrfMiddleware</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-84" name="line-84"></a><span>    </span><span class="hs-comment">-- For details, see the CSRF documentation in the Yesod.Core.Handler module of the yesod-core package.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-85" name="line-85"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323798715" name="local-8214565720323798715"><span class="hs-identifier">yesodMiddleware</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">defaultYesodMiddleware</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-86" name="line-86"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-87" name="line-87"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323798730" name="local-8214565720323798730"><span class="hs-identifier">defaultLayout</span></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445899" name="local-6989586621679445899"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445899"><span class="hs-identifier">widget</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-88" name="line-88"></a><span>        </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445900" name="local-6989586621679445900"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445900"><span class="hs-identifier">master</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getYesod</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-89" name="line-89"></a><span>        </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445901" name="local-6989586621679445901"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445901"><span class="hs-identifier">mmsg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getMessage</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-90" name="line-90"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-91" name="line-91"></a><span>        </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445902" name="local-6989586621679445902"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445902"><span class="hs-identifier">muser</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybeAuthPair</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-92" name="line-92"></a><span>        </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445903" name="local-6989586621679445903"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445903"><span class="hs-identifier">mcurrentRoute</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getCurrentRoute</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-93" name="line-93"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-94" name="line-94"></a><span>        </span><span class="hs-comment">-- Get the breadcrumbs, as defined in the YesodBreadcrumbs instance.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-95" name="line-95"></a><span>        </span><span class="hs-special">(</span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445904" name="local-6989586621679445904"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445904"><span class="hs-identifier">title</span></a></a><span class="hs-special">,</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445905" name="local-6989586621679445905"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445905"><span class="hs-identifier">parents</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">breadcrumbs</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-96" name="line-96"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-97" name="line-97"></a><span>        </span><span class="hs-comment">-- Define the menu items of the header.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-98" name="line-98"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445906" name="local-6989586621679445906"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445906"><span class="hs-identifier">menuItems</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-99" name="line-99"></a><span>                </span><span class="hs-special">[</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#NavbarLeft"><span class="hs-identifier hs-var">NavbarLeft</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#MenuItem"><span class="hs-identifier hs-var">MenuItem</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-100" name="line-100"></a><span>                    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">menuItemLabel</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Home&quot;</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-101" name="line-101"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">menuItemRoute</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#HomeR"><span class="hs-identifier hs-var">HomeR</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-102" name="line-102"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">menuItemAccessCallback</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-103" name="line-103"></a><span>                    </span><span class="hs-special">}</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-104" name="line-104"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#NavbarLeft"><span class="hs-identifier hs-var">NavbarLeft</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#MenuItem"><span class="hs-identifier hs-var">MenuItem</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-105" name="line-105"></a><span>                    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">menuItemLabel</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Profile&quot;</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-106" name="line-106"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">menuItemRoute</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#ProfileR"><span class="hs-identifier hs-var">ProfileR</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-107" name="line-107"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">menuItemAccessCallback</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445902"><span class="hs-identifier hs-var">muser</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-108" name="line-108"></a><span>                    </span><span class="hs-special">}</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-109" name="line-109"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#NavbarRight"><span class="hs-identifier hs-var">NavbarRight</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#MenuItem"><span class="hs-identifier hs-var">MenuItem</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-110" name="line-110"></a><span>                    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">menuItemLabel</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Login&quot;</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-111" name="line-111"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">menuItemRoute</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#AuthR"><span class="hs-identifier hs-var">AuthR</span></a><span> </span><span class="hs-identifier hs-var">LoginR</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-112" name="line-112"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">menuItemAccessCallback</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNothing</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445902"><span class="hs-identifier hs-var">muser</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-113" name="line-113"></a><span>                    </span><span class="hs-special">}</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-114" name="line-114"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#NavbarRight"><span class="hs-identifier hs-var">NavbarRight</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#MenuItem"><span class="hs-identifier hs-var">MenuItem</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-115" name="line-115"></a><span>                    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">menuItemLabel</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Logout&quot;</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-116" name="line-116"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">menuItemRoute</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#AuthR"><span class="hs-identifier hs-var">AuthR</span></a><span> </span><span class="hs-identifier hs-var">LogoutR</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-117" name="line-117"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">menuItemAccessCallback</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445902"><span class="hs-identifier hs-var">muser</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-118" name="line-118"></a><span>                    </span><span class="hs-special">}</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-119" name="line-119"></a><span>                </span><span class="hs-special">]</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-120" name="line-120"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-121" name="line-121"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445907" name="local-6989586621679445907"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445907"><span class="hs-identifier">navbarLeftMenuItems</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445908"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#NavbarLeft"><span class="hs-identifier hs-var">NavbarLeft</span></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445908" name="local-6989586621679445908"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445908"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445906"><span class="hs-identifier hs-var">menuItems</span></a><span class="hs-special">]</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-122" name="line-122"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445909" name="local-6989586621679445909"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445909"><span class="hs-identifier">navbarRightMenuItems</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445910"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#NavbarRight"><span class="hs-identifier hs-var">NavbarRight</span></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445910" name="local-6989586621679445910"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445910"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445906"><span class="hs-identifier hs-var">menuItems</span></a><span class="hs-special">]</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-123" name="line-123"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-124" name="line-124"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445911" name="local-6989586621679445911"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445911"><span class="hs-identifier">navbarLeftFilteredMenuItems</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445912"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445912" name="local-6989586621679445912"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445912"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445907"><span class="hs-identifier hs-var">navbarLeftMenuItems</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">menuItemAccessCallback</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445912"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-125" name="line-125"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445913" name="local-6989586621679445913"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445913"><span class="hs-identifier">navbarRightFilteredMenuItems</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445914"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445914" name="local-6989586621679445914"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445914"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445909"><span class="hs-identifier hs-var">navbarRightMenuItems</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">menuItemAccessCallback</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445914"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-126" name="line-126"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-127" name="line-127"></a><span>        </span><span class="hs-comment">-- We break up the default layout into two components:</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-128" name="line-128"></a><span>        </span><span class="hs-comment">-- default-layout is the contents of the body tag, and</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-129" name="line-129"></a><span>        </span><span class="hs-comment">-- default-layout-wrapper is the entire page. Since the final</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-130" name="line-130"></a><span>        </span><span class="hs-comment">-- value passed to hamletToRepHtml cannot be a widget, this allows</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-131" name="line-131"></a><span>        </span><span class="hs-comment">-- you to use normal widget features in default-layout.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-132" name="line-132"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-133" name="line-133"></a><span>        </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445943" name="local-6989586621679445943"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445943"><span class="hs-identifier">pc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">widgetToPageContent</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-134" name="line-134"></a><span>            </span><span class="hs-identifier hs-var">addStylesheet</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#StaticR"><span class="hs-identifier hs-var">StaticR</span></a><span> </span><a href="../MyBlog-0.0.0/Settings.StaticFiles.html#css_bootstrap_css"><span class="hs-identifier hs-var">css_bootstrap_css</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-135" name="line-135"></a><span>            </span><span class="hs-operator">$</span><span class="hs-special">(</span><span class="hs-identifier hs-var">widgetFile</span><span> </span><span class="hs-string">&quot;default-layout&quot;</span><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-136" name="line-136"></a><span>        </span><span class="hs-identifier hs-var">withUrlRenderer</span><span> </span><span class="hs-operator">$</span><span class="hs-special">(</span><span class="hs-identifier hs-var">hamletFile</span><span> </span><span class="hs-string">&quot;templates/default-layout-wrapper.hamlet&quot;</span><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-137" name="line-137"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-138" name="line-138"></a><span>    </span><span class="hs-comment">-- The page to be redirected to when authentication is required.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-139" name="line-139"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323798725" name="local-8214565720323798725"><span class="hs-identifier">authRoute</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#AuthR"><span class="hs-identifier hs-var">AuthR</span></a><span> </span><span class="hs-identifier hs-var">LoginR</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-140" name="line-140"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-141" name="line-141"></a><span>    </span><span class="hs-comment">-- Routes not requiring authentication.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-142" name="line-142"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323798727" name="local-8214565720323798727"><span class="hs-identifier">isAuthorized</span></a><span> </span><span class="hs-special">(</span><a href="../MyBlog-0.0.0/Foundation.html#AuthR"><span class="hs-identifier hs-var">AuthR</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Authorized</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-143" name="line-143"></a><span>    </span><span class="hs-identifier">isAuthorized</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#CommentR"><span class="hs-identifier hs-var">CommentR</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Authorized</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-144" name="line-144"></a><span>    </span><span class="hs-identifier">isAuthorized</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#HomeR"><span class="hs-identifier hs-var">HomeR</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Authorized</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-145" name="line-145"></a><span>    </span><span class="hs-identifier">isAuthorized</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#FaviconR"><span class="hs-identifier hs-var">FaviconR</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Authorized</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-146" name="line-146"></a><span>    </span><span class="hs-identifier">isAuthorized</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#RobotsR"><span class="hs-identifier hs-var">RobotsR</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Authorized</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-147" name="line-147"></a><span>    </span><span class="hs-identifier">isAuthorized</span><span> </span><span class="hs-special">(</span><a href="../MyBlog-0.0.0/Foundation.html#StaticR"><span class="hs-identifier hs-var">StaticR</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Authorized</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-148" name="line-148"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-149" name="line-149"></a><span>    </span><span class="hs-identifier">isAuthorized</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#ProfileR"><span class="hs-identifier hs-var">ProfileR</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#isAuthenticated"><span class="hs-identifier hs-var">isAuthenticated</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-150" name="line-150"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-151" name="line-151"></a><span>    </span><span class="hs-comment">-- This function creates static content files in the static folder</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-152" name="line-152"></a><span>    </span><span class="hs-comment">-- and names them based on a hash of their content. This allows</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-153" name="line-153"></a><span>    </span><span class="hs-comment">-- expiration dates to be set far in the future without worry of</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-154" name="line-154"></a><span>    </span><span class="hs-comment">-- users receiving stale content.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-155" name="line-155"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323798733" name="local-8214565720323798733"><span class="hs-identifier">addStaticContent</span></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446159" name="local-6989586621679446159"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446159"><span class="hs-identifier">ext</span></a></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446160" name="local-6989586621679446160"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446160"><span class="hs-identifier">mime</span></a></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446161" name="local-6989586621679446161"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446161"><span class="hs-identifier">content</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-156" name="line-156"></a><span>        </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446164" name="local-6989586621679446164"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446164"><span class="hs-identifier">master</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getYesod</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-157" name="line-157"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446165" name="local-6989586621679446165"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446165"><span class="hs-identifier">staticDir</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">appStaticDir</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">appSettings</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446164"><span class="hs-identifier hs-var">master</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-158" name="line-158"></a><span>        </span><span class="hs-identifier hs-var">addStaticContentExternal</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-159" name="line-159"></a><span>            </span><span class="hs-identifier hs-var">minifym</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-160" name="line-160"></a><span>            </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446162"><span class="hs-identifier hs-var">genFileName</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-161" name="line-161"></a><span>            </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446165"><span class="hs-identifier hs-var">staticDir</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-162" name="line-162"></a><span>            </span><span class="hs-special">(</span><a href="../MyBlog-0.0.0/Foundation.html#StaticR"><span class="hs-identifier hs-var">StaticR</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">StaticRoute</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-163" name="line-163"></a><span>            </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446159"><span class="hs-identifier hs-var">ext</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-164" name="line-164"></a><span>            </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446160"><span class="hs-identifier hs-var">mime</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-165" name="line-165"></a><span>            </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446161"><span class="hs-identifier hs-var">content</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-166" name="line-166"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-167" name="line-167"></a><span>        </span><span class="hs-comment">-- Generate a unique filename based on the content itself</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-168" name="line-168"></a><span>        </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446162" name="local-6989586621679446162"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446162"><span class="hs-identifier">genFileName</span></a></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446163" name="local-6989586621679446163"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446163"><span class="hs-identifier">lbs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;autogen-&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">base64md5</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446163"><span class="hs-identifier hs-var">lbs</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-169" name="line-169"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-170" name="line-170"></a><span>    </span><span class="hs-comment">-- What messages should be logged. The following includes all messages when</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-171" name="line-171"></a><span>    </span><span class="hs-comment">-- in development, and warnings and errors in production.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-172" name="line-172"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323798717" name="local-8214565720323798717"><span class="hs-identifier">shouldLog</span></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446166" name="local-6989586621679446166"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446166"><span class="hs-identifier">app</span></a></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446167" name="local-6989586621679446167"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446167"><span class="hs-identifier">_source</span></a></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446168" name="local-6989586621679446168"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446168"><span class="hs-identifier">level</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-173" name="line-173"></a><span>        </span><span class="hs-identifier">appShouldLogAll</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">appSettings</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446166"><span class="hs-identifier hs-var">app</span></a><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-174" name="line-174"></a><span>            </span><span class="hs-operator hs-var">||</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446168"><span class="hs-identifier hs-var">level</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">LevelWarn</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-175" name="line-175"></a><span>            </span><span class="hs-operator hs-var">||</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446168"><span class="hs-identifier hs-var">level</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">LevelError</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-176" name="line-176"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-177" name="line-177"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323798723" name="local-8214565720323798723"><span class="hs-identifier">makeLogger</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">appLogger</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-178" name="line-178"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-179" name="line-179"></a><span>    </span><span class="hs-comment">-- Provide proper Bootstrap styling for default displays, like</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-180" name="line-180"></a><span>    </span><span class="hs-comment">-- error pages</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-181" name="line-181"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323798713" name="local-8214565720323798713"><span class="hs-identifier">defaultMessageWidget</span></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446169" name="local-6989586621679446169"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446169"><span class="hs-identifier">title</span></a></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446170" name="local-6989586621679446170"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679446170"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-operator">$</span><span class="hs-special">(</span><span class="hs-identifier hs-var">widgetFile</span><span> </span><span class="hs-string">&quot;default-message-widget&quot;</span><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-182" name="line-182"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-183" name="line-183"></a><span class="hs-comment">-- Define breadcrumbs.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-184" name="line-184"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">YesodBreadcrumbs</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier hs-type">App</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-185" name="line-185"></a><span>  </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323798647" name="local-8214565720323798647"><span class="hs-identifier">breadcrumb</span></a><span> </span><a href="../MyBlog-0.0.0/Foundation.html#HomeR"><span class="hs-identifier hs-var">HomeR</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Home&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-186" name="line-186"></a><span>  </span><span class="hs-identifier">breadcrumb</span><span> </span><span class="hs-special">(</span><a href="../MyBlog-0.0.0/Foundation.html#AuthR"><span class="hs-identifier hs-var">AuthR</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Login&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#HomeR"><span class="hs-identifier hs-var">HomeR</span></a><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-187" name="line-187"></a><span>  </span><span class="hs-identifier">breadcrumb</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#ProfileR"><span class="hs-identifier hs-var">ProfileR</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Profile&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#HomeR"><span class="hs-identifier hs-var">HomeR</span></a><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-188" name="line-188"></a><span>  </span><span class="hs-identifier">breadcrumb</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;home&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-189" name="line-189"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-190" name="line-190"></a><span class="hs-comment">-- How to run database actions.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-191" name="line-191"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">YesodPersist</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier hs-type">App</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-192" name="line-192"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">YesodPersistBackend</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier hs-type">App</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">SqlBackend</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-193" name="line-193"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323799162" name="local-8214565720323799162"><span class="hs-identifier">runDB</span></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445270" name="local-6989586621679445270"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445270"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-194" name="line-194"></a><span>        </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445809" name="local-6989586621679445809"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445809"><span class="hs-identifier">master</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getYesod</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-195" name="line-195"></a><span>        </span><span class="hs-identifier hs-var">runSqlPool</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445270"><span class="hs-identifier hs-var">action</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">appConnPool</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445809"><span class="hs-identifier hs-var">master</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-196" name="line-196"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">YesodPersistRunner</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier hs-type">App</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-197" name="line-197"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323799165" name="local-8214565720323799165"><span class="hs-identifier">getDBRunner</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">defaultGetDBRunner</span><span> </span><span class="hs-identifier">appConnPool</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-198" name="line-198"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-199" name="line-199"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">YesodAuth</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier hs-type">App</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-200" name="line-200"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">AuthId</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier hs-type">App</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../MyBlog-0.0.0/Model.html#UserId"><span class="hs-identifier hs-type">UserId</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-201" name="line-201"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-202" name="line-202"></a><span>    </span><span class="hs-comment">-- Where to send a user after successful login</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-203" name="line-203"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323832931" name="local-8214565720323832931"><span class="hs-identifier">loginDest</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#HomeR"><span class="hs-identifier hs-var">HomeR</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-204" name="line-204"></a><span>    </span><span class="hs-comment">-- Where to send a user after logout</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-205" name="line-205"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323832930" name="local-8214565720323832930"><span class="hs-identifier">logoutDest</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#HomeR"><span class="hs-identifier hs-var">HomeR</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-206" name="line-206"></a><span>    </span><span class="hs-comment">-- Override the above two destinations when a Referer: header is present</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-207" name="line-207"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323832924" name="local-8214565720323832924"><span class="hs-identifier">redirectToReferer</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-208" name="line-208"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-209" name="line-209"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323832929" name="local-8214565720323832929"><span class="hs-identifier">authenticate</span></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445126" name="local-6989586621679445126"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445126"><span class="hs-identifier">creds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runDB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-210" name="line-210"></a><span>        </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445176" name="local-6989586621679445176"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445176"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getBy</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../MyBlog-0.0.0/Model.html#UniqueUser"><span class="hs-identifier hs-var">UniqueUser</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">credsIdent</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445126"><span class="hs-identifier hs-var">creds</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-211" name="line-211"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445176"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-212" name="line-212"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Entity</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445177" name="local-6989586621679445177"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445177"><span class="hs-identifier">uid</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Authenticated</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445177"><span class="hs-identifier hs-var">uid</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-213" name="line-213"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Authenticated</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">insert</span><span> </span><a href="../MyBlog-0.0.0/Model.html#User"><span class="hs-identifier hs-var">User</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-214" name="line-214"></a><span>                </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">userIdent</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">credsIdent</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445126"><span class="hs-identifier hs-var">creds</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-215" name="line-215"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">userPassword</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-216" name="line-216"></a><span>                </span><span class="hs-special">}</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-217" name="line-217"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-218" name="line-218"></a><span>    </span><span class="hs-comment">-- You can add other plugins like Google Email, email or OAuth here</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-219" name="line-219"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323832927" name="local-8214565720323832927"><span class="hs-identifier">authPlugins</span></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445178" name="local-6989586621679445178"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445178"><span class="hs-identifier">app</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">authOpenId</span><span> </span><span class="hs-identifier hs-var">Claimed</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445179"><span class="hs-identifier hs-var">extraAuthPlugins</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-220" name="line-220"></a><span>        </span><span class="hs-comment">-- Enable authDummy login if enabled.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-221" name="line-221"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445179" name="local-6989586621679445179"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445179"><span class="hs-identifier">extraAuthPlugins</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">authDummy</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">appAuthDummyLogin</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">appSettings</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679445178"><span class="hs-identifier hs-var">app</span></a><span class="hs-special">]</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-222" name="line-222"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-223" name="line-223"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323832923" name="local-8214565720323832923"><span class="hs-identifier">authHttpManager</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">getHttpManager</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-224" name="line-224"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-225" name="line-225"></a><span class="hs-comment">-- | Access function to determine if a user is logged in.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-226" name="line-226"></a><span class="hs-identifier">isAuthenticated</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#Handler"><span class="hs-identifier hs-type">Handler</span></a><span> </span><span class="hs-identifier hs-type">AuthResult</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-227" name="line-227"></a><a href="../MyBlog-0.0.0/src/Foundation.html#isAuthenticated" name="isAuthenticated"><a href="../MyBlog-0.0.0/Foundation.html#isAuthenticated"><span class="hs-identifier">isAuthenticated</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-228" name="line-228"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679444508" name="local-6989586621679444508"><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679444508"><span class="hs-identifier">muid</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybeAuthId</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-229" name="line-229"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679444508"><span class="hs-identifier hs-var">muid</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-230" name="line-230"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Unauthorized</span><span> </span><span class="hs-string">&quot;You must login to access this page&quot;</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-231" name="line-231"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Authorized</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-232" name="line-232"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-233" name="line-233"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">YesodAuthPersist</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier hs-type">App</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-234" name="line-234"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-235" name="line-235"></a><span class="hs-comment">-- This instance is required to use forms. You can modify renderMessage to</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-236" name="line-236"></a><span class="hs-comment">-- achieve customized and internationalized form validation messages.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-237" name="line-237"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier hs-type">App</span></a><span> </span><span class="hs-identifier hs-type">FormMessage</span><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-238" name="line-238"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323799174" name="local-8214565720323799174"><span class="hs-identifier">renderMessage</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">defaultFormMessage</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-239" name="line-239"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-240" name="line-240"></a><span class="hs-comment">-- Useful when writing code that is re-usable outside of the Handler context.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-241" name="line-241"></a><span class="hs-comment">-- An example is background jobs that send email.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-242" name="line-242"></a><span class="hs-comment">-- This can also be useful for writing code that works across multiple Yesod applications.</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-243" name="line-243"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">HasHttpManager</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier hs-type">App</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-244" name="line-244"></a><span>    </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-8214565720323799723" name="local-8214565720323799723"><span class="hs-identifier">getHttpManager</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">appHttpManager</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-245" name="line-245"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-246" name="line-246"></a><span class="hs-identifier">unsafeHandler</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#App"><span class="hs-identifier hs-type">App</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../MyBlog-0.0.0/Foundation.html#Handler"><span class="hs-identifier hs-type">Handler</span></a><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679444507"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="../MyBlog-0.0.0/src/Foundation.html#local-6989586621679444507"><span class="hs-identifier hs-type">a</span></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-247" name="line-247"></a><a href="../MyBlog-0.0.0/src/Foundation.html#unsafeHandler" name="unsafeHandler"><a href="../MyBlog-0.0.0/Foundation.html#unsafeHandler"><span class="hs-identifier">unsafeHandler</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Unsafe</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fakeHandlerGetLogger</span><span> </span><span class="hs-identifier">appLogger</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-248" name="line-248"></a><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-249" name="line-249"></a><span class="hs-comment">-- Note: Some functionality previously present in the scaffolding has been</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-250" name="line-250"></a><span class="hs-comment">-- moved to documentation in the Wiki. Following are some hopefully helpful</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-251" name="line-251"></a><span class="hs-comment">-- links:</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-252" name="line-252"></a><span class="hs-comment">--</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-253" name="line-253"></a><span class="hs-comment">-- https://github.com/yesodweb/yesod/wiki/Sending-email</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-254" name="line-254"></a><span class="hs-comment">-- https://github.com/yesodweb/yesod/wiki/Serve-static-files-from-a-separate-domain</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-255" name="line-255"></a><span class="hs-comment">-- https://github.com/yesodweb/yesod/wiki/i18n-messages-in-the-scaffolding</span><span>
</span><a href="../MyBlog-0.0.0/src/Foundation.html#line-256" name="line-256"></a></pre></body></html>