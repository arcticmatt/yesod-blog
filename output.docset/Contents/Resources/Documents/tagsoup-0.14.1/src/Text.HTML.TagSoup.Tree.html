<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css"></link><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
    /NOTE/: This module is preliminary and may change at a future date.

    This module is intended to help converting a list of tags into a
    tree of tags.
-}</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-7" name="line-7"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-8" name="line-8"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">HTML</span><span class="hs-operator">.</span><span class="hs-identifier">TagSoup</span><span class="hs-operator">.</span><span class="hs-identifier">Tree</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-9" name="line-9"></a><span>    </span><span class="hs-special">(</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-10" name="line-10"></a><span>    </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#tagTree"><span class="hs-identifier hs-var">tagTree</span></a><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#parseTree"><span class="hs-identifier hs-var">parseTree</span></a><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#parseTreeOptions"><span class="hs-identifier hs-var">parseTreeOptions</span></a><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Options.html#ParseOptions"><span class="hs-identifier hs-type">ParseOptions</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-11" name="line-11"></a><span>    </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#flattenTree"><span class="hs-identifier hs-var">flattenTree</span></a><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#renderTree"><span class="hs-identifier hs-var">renderTree</span></a><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#renderTreeOptions"><span class="hs-identifier hs-var">renderTreeOptions</span></a><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Render.html#RenderOptions"><span class="hs-identifier hs-type">RenderOptions</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#transformTree"><span class="hs-identifier hs-var">transformTree</span></a><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#universeTree"><span class="hs-identifier hs-var">universeTree</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-12" name="line-12"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-13" name="line-13"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-14" name="line-14"></a><span class="hs-keyword">import</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.html"><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">HTML</span><span class="hs-operator">.</span><span class="hs-identifier">TagSoup</span></a><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Parser.html#parseTags"><span class="hs-identifier hs-var">parseTags</span></a><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Parser.html#parseTagsOptions"><span class="hs-identifier hs-var">parseTagsOptions</span></a><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Render.html#renderTags"><span class="hs-identifier hs-var">renderTags</span></a><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Render.html#renderTagsOptions"><span class="hs-identifier hs-var">renderTagsOptions</span></a><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Options.html#ParseOptions"><span class="hs-identifier hs-type">ParseOptions</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Render.html#RenderOptions"><span class="hs-identifier hs-type">RenderOptions</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-15" name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html"><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">HTML</span><span class="hs-operator">.</span><span class="hs-identifier">TagSoup</span><span class="hs-operator">.</span><span class="hs-identifier">Type</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-16" name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Arrow</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-17" name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Exts</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">build</span><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-18" name="line-18"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-19" name="line-19"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-20" name="line-20"></a><span class="hs-comment">-- | A tree of 'Tag' values.</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-21" name="line-21"></a><span class="hs-keyword">data</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#TagTree" name="TagTree"><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier">TagTree</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069888" name="local-6989586621679069888"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069888"><span class="hs-identifier">str</span></a></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-22" name="line-22"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | A 'TagOpen'/'TagClose' pair with the 'Tag' values in between.</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-23" name="line-23"></a><span>      </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#TagBranch" name="TagBranch"><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier">TagBranch</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069888"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069888"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069888"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-24" name="line-24"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Any leaf node</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-25" name="line-25"></a><span>      </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#TagLeaf" name="TagLeaf"><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier">TagLeaf</span></a></a><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069888"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-26" name="line-26"></a><span>                   </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-27" name="line-27"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-28" name="line-28"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-29" name="line-29"></a><span>    </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-3458764513820541101" name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069949" name="local-6989586621679069949"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069949"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069950" name="local-6989586621679069950"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069950"><span class="hs-identifier">x</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069951" name="local-6989586621679069951"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069951"><span class="hs-identifier">y</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069952" name="local-6989586621679069952"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069952"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069949"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069950"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069949"><span class="hs-identifier hs-var">f</span></a><span class="hs-operator hs-var">***</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069949"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069951"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069949"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069952"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-30" name="line-30"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069953" name="local-6989586621679069953"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069953"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069954" name="local-6989586621679069954"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069954"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069953"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069954"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-31" name="line-31"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-32" name="line-32"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-33" name="line-33"></a><span class="hs-comment">-- | Convert a list of tags into a tree. This version is not lazy at</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-34" name="line-34"></a><span class="hs-comment">--   all, that is saved for version 2.</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-35" name="line-35"></a><span class="hs-identifier">tagTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069898"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069898"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069898"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-36" name="line-36"></a><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#tagTree" name="tagTree"><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#tagTree"><span class="hs-identifier">tagTree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069899"><span class="hs-identifier hs-var">g</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-37" name="line-37"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-38" name="line-38"></a><span>        </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069901"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069901"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069901"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-39" name="line-39"></a><span>        </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069899" name="local-6989586621679069899"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069899"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-40" name="line-40"></a><span>        </span><span class="hs-identifier">g</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069903" name="local-6989586621679069903"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069903"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069904"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-number">1</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069905"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069899"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">1</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069905"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-41" name="line-41"></a><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069904" name="local-6989586621679069904"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069904"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069905" name="local-6989586621679069905"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069905"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069900"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069903"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-42" name="line-42"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-43" name="line-43"></a><span>        </span><span class="hs-comment">-- the second tuple is either null or starts with a close</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-44" name="line-44"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069902"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069902"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069902"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069902"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-45" name="line-45"></a><span>        </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069900" name="local-6989586621679069900"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069900"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#TagOpen"><span class="hs-identifier hs-var">TagOpen</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069906" name="local-6989586621679069906"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069906"><span class="hs-identifier">name</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069907" name="local-6989586621679069907"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069907"><span class="hs-identifier">atts</span></a></a><span class="hs-glyph">:</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069908" name="local-6989586621679069908"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069908"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-46" name="line-46"></a><span>            </span><span class="hs-keyword">case</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069900"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069908"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-47" name="line-47"></a><span>                </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069909" name="local-6989586621679069909"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069909"><span class="hs-identifier">inner</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#TagOpen"><span class="hs-identifier hs-var">TagOpen</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069906"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069907"><span class="hs-identifier hs-var">atts</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069909"><span class="hs-identifier hs-var">inner</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-48" name="line-48"></a><span>                </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069910" name="local-6989586621679069910"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069910"><span class="hs-identifier">inner</span></a></a><span class="hs-special">,</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#TagClose"><span class="hs-identifier hs-var">TagClose</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069911" name="local-6989586621679069911"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069911"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069912" name="local-6989586621679069912"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069912"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-49" name="line-49"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069911"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069906"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069913" name="local-6989586621679069913"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069913"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069914" name="local-6989586621679069914"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069914"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069900"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069912"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069906"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069907"><span class="hs-identifier hs-var">atts</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069910"><span class="hs-identifier hs-var">inner</span></a><span class="hs-glyph">:</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069913"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069914"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-50" name="line-50"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#TagOpen"><span class="hs-identifier hs-var">TagOpen</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069906"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069907"><span class="hs-identifier hs-var">atts</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069910"><span class="hs-identifier hs-var">inner</span></a><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#TagClose"><span class="hs-identifier hs-var">TagClose</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069911"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069912"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-51" name="line-51"></a><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TagSoup.Tree.tagTree: safe as - forall x . isTagClose (snd (f x))&quot;</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-52" name="line-52"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-53" name="line-53"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#TagClose"><span class="hs-identifier hs-var">TagClose</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069915" name="local-6989586621679069915"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069915"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069916" name="local-6989586621679069916"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069916"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#TagClose"><span class="hs-identifier hs-var">TagClose</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069915"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069916"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-54" name="line-54"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069917" name="local-6989586621679069917"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069917"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069918" name="local-6989586621679069918"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069918"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069917"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069919"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069920"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-55" name="line-55"></a><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069919" name="local-6989586621679069919"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069919"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069920" name="local-6989586621679069920"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069920"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069900"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069918"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-56" name="line-56"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-57" name="line-57"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-58" name="line-58"></a><span class="hs-comment">-- | Build a 'TagTree' from a string.</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-59" name="line-59"></a><span class="hs-identifier">parseTree</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../tagsoup-0.14.1/Text.StringLike.html#StringLike"><span class="hs-identifier hs-type">StringLike</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069897"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069897"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069897"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-60" name="line-60"></a><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#parseTree" name="parseTree"><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#parseTree"><span class="hs-identifier">parseTree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#tagTree"><span class="hs-identifier hs-var">tagTree</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Parser.html#parseTags"><span class="hs-identifier hs-var">parseTags</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-61" name="line-61"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-62" name="line-62"></a><span class="hs-comment">-- | Build a 'TagTree' from a string, specifying the 'ParseOptions'.</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-63" name="line-63"></a><span class="hs-identifier">parseTreeOptions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../tagsoup-0.14.1/Text.StringLike.html#StringLike"><span class="hs-identifier hs-type">StringLike</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069896"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Options.html#ParseOptions"><span class="hs-identifier hs-type">ParseOptions</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069896"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069896"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069896"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-64" name="line-64"></a><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#parseTreeOptions" name="parseTreeOptions"><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#parseTreeOptions"><span class="hs-identifier">parseTreeOptions</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069921" name="local-6989586621679069921"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069921"><span class="hs-identifier">opts</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069922" name="local-6989586621679069922"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069922"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#tagTree"><span class="hs-identifier hs-var">tagTree</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Parser.html#parseTagsOptions"><span class="hs-identifier hs-var">parseTagsOptions</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069921"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069922"><span class="hs-identifier hs-var">str</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-65" name="line-65"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-66" name="line-66"></a><span class="hs-comment">-- | Flatten a 'TagTree' back to a list of 'Tag'.</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-67" name="line-67"></a><span class="hs-identifier">flattenTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069895"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069895"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-68" name="line-68"></a><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#flattenTree" name="flattenTree"><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#flattenTree"><span class="hs-identifier">flattenTree</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069923" name="local-6989586621679069923"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069923"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#flattenTreeFB"><span class="hs-identifier hs-var">flattenTreeFB</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069923"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-69" name="line-69"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-70" name="line-70"></a><span class="hs-identifier">flattenTreeFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069893"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069893"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069894"><span class="hs-identifier hs-type">lst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069894"><span class="hs-identifier hs-type">lst</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069894"><span class="hs-identifier hs-type">lst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069894"><span class="hs-identifier hs-type">lst</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-71" name="line-71"></a><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#flattenTreeFB" name="flattenTreeFB"><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#flattenTreeFB"><span class="hs-identifier">flattenTreeFB</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069924" name="local-6989586621679069924"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069924"><span class="hs-identifier">xs</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069925" name="local-6989586621679069925"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069925"><span class="hs-identifier">cons</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069926" name="local-6989586621679069926"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069926"><span class="hs-identifier">nil</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069927"><span class="hs-identifier hs-var">flattenTreeOnto</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069924"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069926"><span class="hs-identifier hs-var">nil</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-72" name="line-72"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-73" name="line-73"></a><span>        </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069927" name="local-6989586621679069927"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069927"><span class="hs-identifier">flattenTreeOnto</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069928" name="local-6989586621679069928"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069928"><span class="hs-identifier">tags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069928"><span class="hs-identifier hs-var">tags</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-74" name="line-74"></a><span>        </span><span class="hs-identifier">flattenTreeOnto</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069929" name="local-6989586621679069929"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069929"><span class="hs-identifier">name</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069930" name="local-6989586621679069930"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069930"><span class="hs-identifier">atts</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069931" name="local-6989586621679069931"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069931"><span class="hs-identifier">inner</span></a></a><span class="hs-glyph">:</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069932" name="local-6989586621679069932"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069932"><span class="hs-identifier">trs</span></a></a><span class="hs-special">)</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069933" name="local-6989586621679069933"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069933"><span class="hs-identifier">tags</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-75" name="line-75"></a><span>            </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#TagOpen"><span class="hs-identifier hs-var">TagOpen</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069929"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069930"><span class="hs-identifier hs-var">atts</span></a><span> </span><span class="hs-special">`</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069925"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">`</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069927"><span class="hs-identifier hs-var">flattenTreeOnto</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069931"><span class="hs-identifier hs-var">inner</span></a><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Type.html#TagClose"><span class="hs-identifier hs-var">TagClose</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069929"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">`</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069925"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">`</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069927"><span class="hs-identifier hs-var">flattenTreeOnto</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069932"><span class="hs-identifier hs-var">trs</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069933"><span class="hs-identifier hs-var">tags</span></a><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-76" name="line-76"></a><span>        </span><span class="hs-identifier">flattenTreeOnto</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069934" name="local-6989586621679069934"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069934"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069935" name="local-6989586621679069935"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069935"><span class="hs-identifier">trs</span></a></a><span class="hs-special">)</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069936" name="local-6989586621679069936"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069936"><span class="hs-identifier">tags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069934"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069925"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">`</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069927"><span class="hs-identifier hs-var">flattenTreeOnto</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069935"><span class="hs-identifier hs-var">trs</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069936"><span class="hs-identifier hs-var">tags</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-77" name="line-77"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-78" name="line-78"></a><span class="hs-comment">-- | Render a 'TagTree'.</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-79" name="line-79"></a><span class="hs-identifier">renderTree</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../tagsoup-0.14.1/Text.StringLike.html#StringLike"><span class="hs-identifier hs-type">StringLike</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069892"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069892"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069892"><span class="hs-identifier hs-type">str</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-80" name="line-80"></a><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#renderTree" name="renderTree"><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#renderTree"><span class="hs-identifier">renderTree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Render.html#renderTags"><span class="hs-identifier hs-var">renderTags</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#flattenTree"><span class="hs-identifier hs-var">flattenTree</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-81" name="line-81"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-82" name="line-82"></a><span class="hs-comment">-- | Render a 'TagTree' with some 'RenderOptions'.</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-83" name="line-83"></a><span class="hs-identifier">renderTreeOptions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../tagsoup-0.14.1/Text.StringLike.html#StringLike"><span class="hs-identifier hs-type">StringLike</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069891"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Render.html#RenderOptions"><span class="hs-identifier hs-type">RenderOptions</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069891"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069891"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069891"><span class="hs-identifier hs-type">str</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-84" name="line-84"></a><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#renderTreeOptions" name="renderTreeOptions"><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#renderTreeOptions"><span class="hs-identifier">renderTreeOptions</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069937" name="local-6989586621679069937"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069937"><span class="hs-identifier">opts</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069938" name="local-6989586621679069938"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069938"><span class="hs-identifier">trees</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Render.html#renderTagsOptions"><span class="hs-identifier hs-var">renderTagsOptions</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069937"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#flattenTree"><span class="hs-identifier hs-var">flattenTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069938"><span class="hs-identifier hs-var">trees</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-85" name="line-85"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-86" name="line-86"></a><span class="hs-comment">-- | This operation is based on the Uniplate @universe@ function. Given a</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-87" name="line-87"></a><span class="hs-comment">--   list of trees, it returns those trees, and all the children trees at</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-88" name="line-88"></a><span class="hs-comment">--   any level. For example:</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-89" name="line-89"></a><span class="hs-comment">--</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-90" name="line-90"></a><span class="hs-comment">-- &gt; universeTree</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-91" name="line-91"></a><span class="hs-comment">-- &gt;    [TagBranch &quot;a&quot; [(&quot;href&quot;,&quot;url&quot;)] [TagBranch &quot;b&quot; [] [TagLeaf (TagText &quot;text&quot;)]]]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-92" name="line-92"></a><span class="hs-comment">-- &gt; == [TagBranch &quot;a&quot; [(&quot;href&quot;,&quot;url&quot;)] [TagBranch &quot;b&quot; [] [TagLeaf (TagText &quot;text&quot;)]]]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-93" name="line-93"></a><span class="hs-comment">-- &gt;    ,TagBranch &quot;b&quot; [] [TagLeaf (TagText &quot;text&quot;)]]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-94" name="line-94"></a><span class="hs-comment">--</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-95" name="line-95"></a><span class="hs-comment">--   This operation is particularly useful for queries. To collect all @\&quot;a\&quot;@</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-96" name="line-96"></a><span class="hs-comment">--   tags in a tree, simply do:</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-97" name="line-97"></a><span class="hs-comment">--</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-98" name="line-98"></a><span class="hs-comment">-- &gt; [x | x@(TagBranch &quot;a&quot; _ _) &lt;- universeTree tree]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-99" name="line-99"></a><span class="hs-identifier">universeTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069890"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069890"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-100" name="line-100"></a><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#universeTree" name="universeTree"><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#universeTree"><span class="hs-identifier">universeTree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069939"><span class="hs-identifier hs-var">f</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-101" name="line-101"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-102" name="line-102"></a><span>        </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069939" name="local-6989586621679069939"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069939"><span class="hs-identifier">f</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069940" name="local-6989586621679069940"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069940"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069941" name="local-6989586621679069941"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069941"><span class="hs-identifier">inner</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069940"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#universeTree"><span class="hs-identifier hs-var">universeTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069941"><span class="hs-identifier hs-var">inner</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-103" name="line-103"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069942" name="local-6989586621679069942"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069942"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069942"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-104" name="line-104"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-105" name="line-105"></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-106" name="line-106"></a><span class="hs-comment">-- | This operation is based on the Uniplate @transform@ function. Given a</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-107" name="line-107"></a><span class="hs-comment">--   list of trees, it applies the function to every tree in a bottom-up</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-108" name="line-108"></a><span class="hs-comment">--   manner. This operation is useful for manipulating a tree - for example</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-109" name="line-109"></a><span class="hs-comment">--   to make all tag names upper case:</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-110" name="line-110"></a><span class="hs-comment">--</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-111" name="line-111"></a><span class="hs-comment">-- &gt; upperCase = transformTree f</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-112" name="line-112"></a><span class="hs-comment">-- &gt;   where f (TagBranch name atts inner) = [TagBranch (map toUpper name) atts inner]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-113" name="line-113"></a><span class="hs-comment">-- &gt;         f x = [x]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-114" name="line-114"></a><span class="hs-identifier">transformTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069889"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069889"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069889"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069889"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-115" name="line-115"></a><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#transformTree" name="transformTree"><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#transformTree"><span class="hs-identifier">transformTree</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069943" name="local-6989586621679069943"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069943"><span class="hs-identifier">act</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069944"><span class="hs-identifier hs-var">f</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-116" name="line-116"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-117" name="line-117"></a><span>        </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069944" name="local-6989586621679069944"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069944"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069945" name="local-6989586621679069945"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069945"><span class="hs-identifier">a</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069946" name="local-6989586621679069946"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069946"><span class="hs-identifier">b</span></a></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069947" name="local-6989586621679069947"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069947"><span class="hs-identifier">inner</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069943"><span class="hs-identifier hs-var">act</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069945"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069946"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="../tagsoup-0.14.1/Text.HTML.TagSoup.Tree.html#transformTree"><span class="hs-identifier hs-var">transformTree</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069943"><span class="hs-identifier hs-var">act</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069947"><span class="hs-identifier hs-var">inner</span></a><span class="hs-special">)</span><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-118" name="line-118"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069948" name="local-6989586621679069948"><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069948"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069943"><span class="hs-identifier hs-var">act</span></a><span> </span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#local-6989586621679069948"><span class="hs-identifier hs-var">x</span></a><span>
</span><a href="../tagsoup-0.14.1/src/Text.HTML.TagSoup.Tree.html#line-119" name="line-119"></a></pre></body></html>