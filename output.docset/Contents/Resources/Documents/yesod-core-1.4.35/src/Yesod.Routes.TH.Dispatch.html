<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css"></link><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RecordWildCards, TemplateHaskell, ViewPatterns #-}</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-2" name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Routes</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span class="hs-operator">.</span><span class="hs-identifier">Dispatch</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-3" name="line-3"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#MkDispatchSettings"><span class="hs-identifier hs-type">MkDispatchSettings</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-4" name="line-4"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#mkDispatchClause"><span class="hs-identifier hs-var">mkDispatchClause</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-5" name="line-5"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#defaultGetHandler"><span class="hs-identifier hs-var">defaultGetHandler</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-6" name="line-6"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-7" name="line-7"></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-8" name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exp</span><span class="hs-special">)</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-9" name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span class="hs-operator">.</span><span class="hs-identifier">Syntax</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-10" name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Web</span><span class="hs-operator">.</span><span class="hs-identifier">PathPieces</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-11" name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">catMaybes</span><span class="hs-special">)</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-12" name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">forM</span><span class="hs-special">)</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-13" name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl'</span><span class="hs-special">)</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-14" name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Arrow</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">second</span><span class="hs-special">)</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-15" name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Random</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">randomRIO</span><span class="hs-special">)</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-16" name="line-16"></a><span class="hs-keyword">import</span><span> </span><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Types.html"><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Routes</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-17" name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toLower</span><span class="hs-special">)</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-18" name="line-18"></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-19" name="line-19"></a><span class="hs-keyword">data</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#MkDispatchSettings" name="MkDispatchSettings"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#MkDispatchSettings"><span class="hs-identifier">MkDispatchSettings</span></a></a><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094660" name="local-6989586621679094660"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094660"><span class="hs-identifier">b</span></a></a><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094661" name="local-6989586621679094661"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094661"><span class="hs-identifier">site</span></a></a><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094662" name="local-6989586621679094662"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094662"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#MkDispatchSettings" name="MkDispatchSettings"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#MkDispatchSettings"><span class="hs-identifier">MkDispatchSettings</span></a></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-20" name="line-20"></a><span>    </span><span class="hs-special">{</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#mdsRunHandler" name="mdsRunHandler"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#mdsRunHandler"><span class="hs-identifier">mdsRunHandler</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-21" name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#mdsSubDispatcher" name="mdsSubDispatcher"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#mdsSubDispatcher"><span class="hs-identifier">mdsSubDispatcher</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-22" name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#mdsGetPathInfo" name="mdsGetPathInfo"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#mdsGetPathInfo"><span class="hs-identifier">mdsGetPathInfo</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-23" name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#mdsSetPathInfo" name="mdsSetPathInfo"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#mdsSetPathInfo"><span class="hs-identifier">mdsSetPathInfo</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-24" name="line-24"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#mdsMethod" name="mdsMethod"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#mdsMethod"><span class="hs-identifier">mdsMethod</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-25" name="line-25"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#mds404" name="mds404"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#mds404"><span class="hs-identifier">mds404</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-26" name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#mds405" name="mds405"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#mds405"><span class="hs-identifier">mds405</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-27" name="line-27"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#mdsGetHandler" name="mdsGetHandler"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#mdsGetHandler"><span class="hs-identifier">mdsGetHandler</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-28" name="line-28"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#mdsUnwrapper" name="mdsUnwrapper"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#mdsUnwrapper"><span class="hs-identifier">mdsUnwrapper</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Exp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-29" name="line-29"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-30" name="line-30"></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-31" name="line-31"></a><span class="hs-keyword">data</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#SDC" name="SDC"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#SDC"><span class="hs-identifier">SDC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#SDC" name="SDC"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#SDC"><span class="hs-identifier">SDC</span></a></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-32" name="line-32"></a><span>    </span><span class="hs-special">{</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#clause404" name="clause404"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#clause404"><span class="hs-identifier">clause404</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Clause</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-33" name="line-33"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#extraParams" name="extraParams"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#extraParams"><span class="hs-identifier">extraParams</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Exp</span><span class="hs-special">]</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-34" name="line-34"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#extraCons" name="extraCons"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#extraCons"><span class="hs-identifier">extraCons</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Exp</span><span class="hs-special">]</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-35" name="line-35"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#envExp" name="envExp"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#envExp"><span class="hs-identifier">envExp</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-36" name="line-36"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#reqExp" name="reqExp"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#reqExp"><span class="hs-identifier">reqExp</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-37" name="line-37"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-38" name="line-38"></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-39" name="line-39"></a><span class="hs-comment">-- | A simpler version of Yesod.Routes.TH.Dispatch.mkDispatchClause, based on</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-40" name="line-40"></a><span class="hs-comment">-- view patterns.</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-41" name="line-41"></a><span class="hs-comment">--</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-42" name="line-42"></a><span class="hs-comment">-- Since 1.4.0</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-43" name="line-43"></a><span class="hs-identifier">mkDispatchClause</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#MkDispatchSettings"><span class="hs-identifier hs-type">MkDispatchSettings</span></a><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094663"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094664"><span class="hs-identifier hs-type">site</span></a><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094665"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Types.html#ResourceTree"><span class="hs-identifier hs-type">ResourceTree</span></a><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094666"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Clause</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-44" name="line-44"></a><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#mkDispatchClause" name="mkDispatchClause"><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#mkDispatchClause"><span class="hs-identifier">mkDispatchClause</span></a></a><span> </span><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#MkDispatchSettings"><span class="hs-identifier hs-var">MkDispatchSettings</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094676" name="local-6989586621679094676"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094676"><span class="hs-identifier">resources</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-45" name="line-45"></a><span>    </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094772" name="local-6989586621679094772"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094772"><span class="hs-identifier">suffix</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">qRunIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">randomRIO</span><span> </span><span class="hs-special">(</span><span class="hs-number">1000</span><span class="hs-special">,</span><span> </span><span class="hs-number">9999</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-46" name="line-46"></a><span>    </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094773" name="local-6989586621679094773"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094773"><span class="hs-identifier">envName</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;env&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094772"><span class="hs-identifier hs-var">suffix</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-47" name="line-47"></a><span>    </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094774" name="local-6989586621679094774"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094774"><span class="hs-identifier">reqName</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;req&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094772"><span class="hs-identifier hs-var">suffix</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-48" name="line-48"></a><span>    </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094775" name="local-6989586621679094775"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094775"><span class="hs-identifier">helperName</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;helper&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094772"><span class="hs-identifier hs-var">suffix</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-49" name="line-49"></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-50" name="line-50"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094776" name="local-6989586621679094776"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094776"><span class="hs-identifier">envE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">VarE</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094773"><span class="hs-identifier hs-var">envName</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-51" name="line-51"></a><span>        </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094777" name="local-6989586621679094777"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094777"><span class="hs-identifier">reqE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">VarE</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094774"><span class="hs-identifier hs-var">reqName</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-52" name="line-52"></a><span>        </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094778" name="local-6989586621679094778"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094778"><span class="hs-identifier">helperE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">VarE</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094775"><span class="hs-identifier hs-var">helperName</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-53" name="line-53"></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-54" name="line-54"></a><span>    </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094779" name="local-6989586621679094779"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094779"><span class="hs-identifier">clause404'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094682"><span class="hs-identifier hs-var">mkClause404</span></a><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094776"><span class="hs-identifier hs-var">envE</span></a><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094777"><span class="hs-identifier hs-var">reqE</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-55" name="line-55"></a><span>    </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094780" name="local-6989586621679094780"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094780"><span class="hs-identifier">getPathInfo</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094669"><span class="hs-identifier hs-var">mdsGetPathInfo</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-56" name="line-56"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094781" name="local-6989586621679094781"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094781"><span class="hs-identifier">pathInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094780"><span class="hs-identifier hs-var">getPathInfo</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">AppE</span><span class="hs-special">`</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094777"><span class="hs-identifier hs-var">reqE</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-57" name="line-57"></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-58" name="line-58"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094782" name="local-6989586621679094782"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094782"><span class="hs-identifier">sdc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Dispatch.html#SDC"><span class="hs-identifier hs-var">SDC</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-59" name="line-59"></a><span>            </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">clause404</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094779"><span class="hs-identifier hs-var">clause404'</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-60" name="line-60"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">extraParams</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-61" name="line-61"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">extraCons</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-62" name="line-62"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">envExp</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094776"><span class="hs-identifier hs-var">envE</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-63" name="line-63"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">reqExp</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094777"><span class="hs-identifier hs-var">reqE</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-64" name="line-64"></a><span>            </span><span class="hs-special">}</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-65" name="line-65"></a><span>    </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094783" name="local-6989586621679094783"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094783"><span class="hs-identifier">clauses</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094681"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094782"><span class="hs-identifier hs-var">sdc</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094676"><span class="hs-identifier hs-var">resources</span></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-66" name="line-66"></a><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-67" name="line-67"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Clause</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-68" name="line-68"></a><span>        </span><span class="hs-special">[</span><span class="hs-identifier hs-var">VarP</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094773"><span class="hs-identifier hs-var">envName</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">VarP</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094774"><span class="hs-identifier hs-var">reqName</span></a><span class="hs-special">]</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-69" name="line-69"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NormalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094778"><span class="hs-identifier hs-var">helperE</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">AppE</span><span class="hs-special">`</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094781"><span class="hs-identifier hs-var">pathInfo</span></a><span class="hs-special">)</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-70" name="line-70"></a><span>        </span><span class="hs-special">[</span><span class="hs-identifier hs-var">FunD</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094775"><span class="hs-identifier hs-var">helperName</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094783"><span class="hs-identifier hs-var">clauses</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094779"><span class="hs-identifier hs-var">clause404'</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-71" name="line-71"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-72" name="line-72"></a><span>    </span><span class="hs-identifier">handlePiece</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Types.html#Piece"><span class="hs-identifier hs-type">Piece</span></a><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094683"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Pat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Exp</span><span class="hs-special">)</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-73" name="line-73"></a><span>    </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094677" name="local-6989586621679094677"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094677"><span class="hs-identifier">handlePiece</span></a></a><span> </span><span class="hs-special">(</span><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Types.html#Static"><span class="hs-identifier hs-var">Static</span></a><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094686" name="local-6989586621679094686"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094686"><span class="hs-identifier">str</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LitP</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">StringL</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094686"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-74" name="line-74"></a><span>    </span><span class="hs-identifier">handlePiece</span><span> </span><span class="hs-special">(</span><a href="../yesod-core-1.4.35/Yesod.Routes.TH.Types.html#Dynamic"><span class="hs-identifier hs-var">Dynamic</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-75" name="line-75"></a><span>        </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094687" name="local-6989586621679094687"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094687"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;dyn&quot;</span><span>
</span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#line-76" name="line-76"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094688" name="local-6989586621679094688"><a href="../yesod-core-1.4.35/src/Yesod.Routes.TH.Dispatch.html#local-6989586621679094688"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ViewP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarE</span><span> </span><span class="hs-char">'fromPathPiece) (ConP 'Just [VarP x])
        return (pat, Just $ VarE x)

    handlePieces :: [Piece a] -&gt; Q ([Pat], [Exp])
    handlePieces = fmap (second catMaybes . unzip) . mapM handlePiece

    mkCon :: String -&gt; [Exp] -&gt; Exp
    mkCon name = foldl' AppE (ConE $ mkName name)

    mkPathPat :: Pat -&gt; [Pat] -&gt; Pat
    mkPathPat final =
        foldr addPat final
      where
        addPat x y = ConP '(:) [x, y]

    go :: SDC -&gt; ResourceTree a -&gt; Q Clause
    go sdc (ResourceParent name _check pieces children) = do
        (pats, dyns) &lt;- handlePieces pieces
        let sdc' = sdc
                { extraParams = extraParams sdc ++ dyns
                , extraCons = extraCons sdc ++ [mkCon name dyns]
                }
        childClauses &lt;- mapM (go sdc') children

        restName &lt;- newName &quot;rest&quot;
        let restE = VarE restName
            restP = VarP restName

        helperName &lt;- newName $ &quot;helper&quot; ++ name
        let helperE = VarE helperName

        return $ Clause
            [mkPathPat restP pats]
            (NormalB $ helperE `AppE` restE)
            [FunD helperName $ childClauses ++ [clause404 sdc]]
    go SDC {..} (ResourceLeaf (Resource name pieces dispatch _ _check)) = do
        (pats, dyns) &lt;- handlePieces pieces

        (chooseMethod, finalPat) &lt;- handleDispatch dispatch dyns

        return $ Clause
            [mkPathPat finalPat pats]
            (NormalB chooseMethod)
            []
      where
        handleDispatch :: Dispatch a -&gt; [Exp] -&gt; Q (Exp, Pat)
        handleDispatch dispatch' dyns =
            case dispatch' of
                Methods multi methods -&gt; do
                    (finalPat, mfinalE) &lt;-
                        case multi of
                            Nothing -&gt; return (ConP '[] [], Nothing)
                            Just _ -&gt; do
                                multiName &lt;- newName &quot;multi&quot;
                                let pat = ViewP (VarE 'fromPathMultiPiece)
                                                (ConP 'Just [VarP multiName])
                                return (pat, Just $ VarE multiName)

                    let dynsMulti =
                            case mfinalE of
                                Nothing -&gt; dyns
                                Just e -&gt; dyns ++ [e]
                        route' = foldl' AppE (ConE (mkName name)) dynsMulti
                        route = foldr AppE route' extraCons
                        jroute = ConE 'Just `AppE` route
                        allDyns = extraParams ++ dynsMulti
                        mkRunExp mmethod = do
                            runHandlerE &lt;- mdsRunHandler
                            handlerE' &lt;- mdsGetHandler mmethod name
                            handlerE &lt;- mdsUnwrapper $ foldl' AppE handlerE' allDyns
                            return $ runHandlerE
                                `AppE` handlerE
                                `AppE` envExp
                                `AppE` jroute
                                `AppE` reqExp

                    func &lt;-
                        case methods of
                            [] -&gt; mkRunExp Nothing
                            _ -&gt; do
                                getMethod &lt;- mdsMethod
                                let methodE = getMethod `AppE` reqExp
                                matches &lt;- forM methods $ \method -&gt; do
                                    exp &lt;- mkRunExp (Just method)
                                    return $ Match (LitP $ StringL method) (NormalB exp) []
                                match405 &lt;- do
                                    runHandlerE &lt;- mdsRunHandler
                                    handlerE &lt;- mds405
                                    let exp = runHandlerE
                                            `AppE` handlerE
                                            `AppE` envExp
                                            `AppE` jroute
                                            `AppE` reqExp
                                    return $ Match WildP (NormalB exp) []
                                return $ CaseE methodE $ matches ++ [match405]

                    return (func, finalPat)
                Subsite _ getSub -&gt; do
                    restPath &lt;- newName &quot;restPath&quot;
                    setPathInfoE &lt;- mdsSetPathInfo
                    subDispatcherE &lt;- mdsSubDispatcher
                    runHandlerE &lt;- mdsRunHandler
                    sub &lt;- newName &quot;sub&quot;
                    let allDyns = extraParams ++ dyns
                    sroute &lt;- newName &quot;sroute&quot;
                    let sub2 = LamE [VarP sub]
                            (foldl' (\a b -&gt; a `AppE` b) (VarE (mkName getSub) `AppE` VarE sub) allDyns)
                    let reqExp' = setPathInfoE `AppE` VarE restPath `AppE` reqExp
                        route' = foldl' AppE (ConE (mkName name)) dyns
                        route = LamE [VarP sroute] $ foldr AppE (AppE route' $ VarE sroute) extraCons
                        exp = subDispatcherE
                            `AppE` runHandlerE
                            `AppE` sub2
                            `AppE` route
                            `AppE` envExp
                            `AppE` reqExp'
                    return (exp, VarP restPath)

    mkClause404 envE reqE = do
        handler &lt;- mds404
        runHandler &lt;- mdsRunHandler
        let exp = runHandler `AppE` handler `AppE` envE `AppE` ConE 'Nothing `AppE` reqE
        return $ Clause [WildP] (NormalB exp) []

defaultGetHandler :: Maybe String -&gt; String -&gt; Q Exp
defaultGetHandler Nothing s = return $ VarE $ mkName $ &quot;handle&quot; ++ s
defaultGetHandler (Just method) s = return $ VarE $ mkName $ map toLower method ++ s
</span></pre></body></html>