<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css"></link><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-2" name="line-2"></a><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-3" name="line-3"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-4" name="line-4"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-5" name="line-5"></a><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-6" name="line-6"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-7" name="line-7"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-8" name="line-8"></a><span class="hs-comment">-- | Field functions allow you to easily create and validate forms, cleanly handling the uncertainty of parsing user input.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-9" name="line-9"></a><span class="hs-comment">--</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-10" name="line-10"></a><span class="hs-comment">-- When possible, the field functions use a specific input type (e.g. &quot;number&quot;), allowing supporting browsers to validate the input before form submission. Browsers can also improve usability with this information; for example, mobile browsers might present a specialized keyboard for an input of type &quot;email&quot; or &quot;number&quot;.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-11" name="line-11"></a><span class="hs-comment">--</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-12" name="line-12"></a><span class="hs-comment">-- See the Yesod book &lt;http://www.yesodweb.com/book/forms chapter on forms&gt; for a broader overview of forms in Yesod.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-13" name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Form</span><span class="hs-operator">.</span><span class="hs-identifier">Fields</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-14" name="line-14"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- * i18n</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-15" name="line-15"></a><span>      </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-16" name="line-16"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#defaultFormMessage"><span class="hs-identifier hs-var">defaultFormMessage</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-17" name="line-17"></a><span>      </span><span class="hs-comment">-- * Fields</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-18" name="line-18"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#textField"><span class="hs-identifier hs-var">textField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-19" name="line-19"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#passwordField"><span class="hs-identifier hs-var">passwordField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-20" name="line-20"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#textareaField"><span class="hs-identifier hs-var">textareaField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-21" name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#hiddenField"><span class="hs-identifier hs-var">hiddenField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-22" name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#intField"><span class="hs-identifier hs-var">intField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-23" name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#dayField"><span class="hs-identifier hs-var">dayField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-24" name="line-24"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#timeField"><span class="hs-identifier hs-var">timeField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-25" name="line-25"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#timeFieldTypeTime"><span class="hs-identifier hs-var">timeFieldTypeTime</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-26" name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#timeFieldTypeText"><span class="hs-identifier hs-var">timeFieldTypeText</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-27" name="line-27"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#htmlField"><span class="hs-identifier hs-var">htmlField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-28" name="line-28"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#emailField"><span class="hs-identifier hs-var">emailField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-29" name="line-29"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#multiEmailField"><span class="hs-identifier hs-var">multiEmailField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-30" name="line-30"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#searchField"><span class="hs-identifier hs-var">searchField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-31" name="line-31"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#AutoFocus"><span class="hs-identifier hs-type">AutoFocus</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-32" name="line-32"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#urlField"><span class="hs-identifier hs-var">urlField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-33" name="line-33"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#doubleField"><span class="hs-identifier hs-var">doubleField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-34" name="line-34"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#parseDate"><span class="hs-identifier hs-var">parseDate</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-35" name="line-35"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#parseTime"><span class="hs-identifier hs-var">parseTime</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-36" name="line-36"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#Textarea"><span class="hs-identifier hs-type">Textarea</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-37" name="line-37"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#boolField"><span class="hs-identifier hs-var">boolField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-38" name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#checkBoxField"><span class="hs-identifier hs-var">checkBoxField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-39" name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#fileField"><span class="hs-identifier hs-var">fileField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-40" name="line-40"></a><span>      </span><span class="hs-comment">-- * File 'AForm's</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-41" name="line-41"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#fileAFormReq"><span class="hs-identifier hs-var">fileAFormReq</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-42" name="line-42"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#fileAFormOpt"><span class="hs-identifier hs-var">fileAFormOpt</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-43" name="line-43"></a><span>      </span><span class="hs-comment">-- * Options</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-44" name="line-44"></a><span>      </span><span class="hs-comment">-- $optionsOverview</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-45" name="line-45"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#selectField"><span class="hs-identifier hs-var">selectField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-46" name="line-46"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#selectFieldList"><span class="hs-identifier hs-var">selectFieldList</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-47" name="line-47"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#radioField"><span class="hs-identifier hs-var">radioField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-48" name="line-48"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#radioFieldList"><span class="hs-identifier hs-var">radioFieldList</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-49" name="line-49"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#checkboxesField"><span class="hs-identifier hs-var">checkboxesField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-50" name="line-50"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#checkboxesFieldList"><span class="hs-identifier hs-var">checkboxesFieldList</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-51" name="line-51"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#multiSelectField"><span class="hs-identifier hs-var">multiSelectField</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-52" name="line-52"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#multiSelectFieldList"><span class="hs-identifier hs-var">multiSelectFieldList</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-53" name="line-53"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#Option"><span class="hs-identifier hs-type">Option</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-54" name="line-54"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-type">OptionList</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-55" name="line-55"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#mkOptionList"><span class="hs-identifier hs-var">mkOptionList</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-56" name="line-56"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#optionsPersist"><span class="hs-identifier hs-var">optionsPersist</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-57" name="line-57"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#optionsPersistKey"><span class="hs-identifier hs-var">optionsPersistKey</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-58" name="line-58"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#optionsPairs"><span class="hs-identifier hs-var">optionsPairs</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-59" name="line-59"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#optionsEnum"><span class="hs-identifier hs-var">optionsEnum</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-60" name="line-60"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-61" name="line-61"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-62" name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html"><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Form</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-63" name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.I18n.English.html"><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Form</span><span class="hs-operator">.</span><span class="hs-identifier">I18n</span><span class="hs-operator">.</span><span class="hs-identifier">English</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-64" name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html"><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Form</span><span class="hs-operator">.</span><span class="hs-identifier">Functions</span></a><span> </span><span class="hs-special">(</span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-65" name="line-65"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-66" name="line-66"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Blaze</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToMarkup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toMarkup</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unsafeByteString</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-67" name="line-67"></a><span class="hs-cpp">#define ToHtml ToMarkup</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-68" name="line-68"></a><span class="hs-cpp">#define toHtml toMarkup</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-69" name="line-69"></a><span class="hs-cpp">#define preEscapedText preEscapedToMarkup</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-70" name="line-70"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Day</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-71" name="line-71"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Email</span><span class="hs-operator">.</span><span class="hs-identifier">Validate</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Email</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-72" name="line-72"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Encoding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">encodeUtf8</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">decodeUtf8With</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-73" name="line-73"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Encoding</span><span class="hs-operator">.</span><span class="hs-identifier">Error</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lenientDecode</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-74" name="line-74"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Network</span><span class="hs-operator">.</span><span class="hs-identifier">URI</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">parseURI</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-75" name="line-75"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Persist</span><span class="hs-operator">.</span><span class="hs-identifier">Sql</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PersistField</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PersistFieldSql</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-76" name="line-76"></a><span class="hs-cpp">#if MIN_VERSION_persistent(2,5,0)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-77" name="line-77"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Persist</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Entity</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SqlType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SqlString</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PersistRecordBackend</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PersistQueryRead</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-78" name="line-78"></a><span class="hs-cpp">#else</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-79" name="line-79"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Persist</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Entity</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SqlType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SqlString</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-80" name="line-80"></a><span class="hs-cpp">#endif</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-81" name="line-81"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">HTML</span><span class="hs-operator">.</span><span class="hs-identifier">SanitizeXSS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sanitizeBalance</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-82" name="line-82"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">when</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unless</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-83" name="line-83"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">partitionEithers</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-84" name="line-84"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">listToMaybe</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-85" name="line-85"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-86" name="line-86"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Blaze</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span class="hs-operator">.</span><span class="hs-identifier">Builder</span><span class="hs-operator">.</span><span class="hs-identifier">Html</span><span class="hs-operator">.</span><span class="hs-identifier">Utf8</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">B</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-87" name="line-87"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Blaze</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span class="hs-operator">.</span><span class="hs-identifier">Builder</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">writeByteString</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toLazyByteString</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-88" name="line-88"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Blaze</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span class="hs-operator">.</span><span class="hs-identifier">Builder</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span class="hs-operator">.</span><span class="hs-identifier">Write</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromWriteList</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-89" name="line-89"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-90" name="line-90"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Blaze</span><span class="hs-operator">.</span><span class="hs-identifier">Html</span><span class="hs-operator">.</span><span class="hs-identifier">Renderer</span><span class="hs-operator">.</span><span class="hs-identifier">String</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">renderHtml</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-91" name="line-91"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-92" name="line-92"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-93" name="line-93"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">append</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">concat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">cons</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">head</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-94" name="line-94"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">intercalate</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">null</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unpack</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pack</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">splitOn</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-95" name="line-95"></a><span>                      </span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-96" name="line-96"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-97" name="line-97"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Read</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-98" name="line-98"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-99" name="line-99"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-100" name="line-100"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Persist</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">selectList</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Filter</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SelectOpt</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Key</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-101" name="line-101"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Arrow</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-102" name="line-102"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-103" name="line-103"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;|&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-104" name="line-104"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-105" name="line-105"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Attoparsec</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Parser</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">char</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">string</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">digit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">skipSpace</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">endOfInput</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseOnly</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-106" name="line-106"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-107" name="line-107"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Yesod</span><span class="hs-operator">.</span><span class="hs-identifier">Persist</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-108" name="line-108"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-109" name="line-109"></a><span class="hs-identifier">defaultFormMessage</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-110" name="line-110"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#defaultFormMessage" name="defaultFormMessage"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#defaultFormMessage"><span class="hs-identifier">defaultFormMessage</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.I18n.English.html#englishFormMessage"><span class="hs-identifier hs-var">englishFormMessage</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-111" name="line-111"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-112" name="line-112"></a><span class="hs-comment">-- | Creates a input with @type=&quot;number&quot;@ and @step=1@.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-113" name="line-113"></a><span class="hs-identifier">intField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133318"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133319"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133318"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133318"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133319"><span class="hs-identifier hs-type">i</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-114" name="line-114"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#intField" name="intField"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#intField"><span class="hs-identifier">intField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-115" name="line-115"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133323" name="local-6989586621679133323"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133323"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-116" name="line-116"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Data</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Text</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Read</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">signed</span><span> </span><span class="hs-identifier hs-var">Data</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Text</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Read</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">decimal</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133323"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-117" name="line-117"></a><span>            </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133324" name="local-6989586621679133324"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133324"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133324"><span class="hs-identifier hs-var">a</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-118" name="line-118"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#MsgInvalidInteger"><span class="hs-identifier hs-var">MsgInvalidInteger</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133323"><span class="hs-identifier hs-var">s</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-119" name="line-119"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-120" name="line-120"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133325" name="local-6989586621679133325"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133325"><span class="hs-identifier">theId</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133326" name="local-6989586621679133326"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133326"><span class="hs-identifier">name</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133327" name="local-6989586621679133327"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133327"><span class="hs-identifier">attrs</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133328" name="local-6989586621679133328"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133328"><span class="hs-identifier">val</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133329" name="local-6989586621679133329"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133329"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">hamlet</span><span class="hs-glyph">|</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-121" name="line-121"></a><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">newline</span><span> </span><span class="hs-identifier hs-var">never</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-122" name="line-122"></a><span class="hs-operator hs-var">&lt;</span><span class="hs-identifier hs-var">input</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{theId}&quot;</span><span> </span><span class="hs-identifier hs-var">name</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{name}&quot;</span><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">{</span><span class="hs-identifier hs-var">attrs</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">type</span><span class="hs-glyph">=</span><span class="hs-string">&quot;number&quot;</span><span> </span><span class="hs-identifier hs-var">step</span><span class="hs-glyph">=</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">isReq</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">required</span><span class="hs-glyph">=</span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier hs-var">value</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{showVal val}&quot;</span><span class="hs-operator hs-var">&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-123" name="line-123"></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-124" name="line-124"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-125" name="line-125"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-126" name="line-126"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-127" name="line-127"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133320" name="local-6989586621679133320"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133320"><span class="hs-identifier">showVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133321"><span class="hs-identifier hs-var">showI</span></a><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-128" name="line-128"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133321" name="local-6989586621679133321"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133321"><span class="hs-identifier">showI</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133322" name="local-6989586621679133322"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133322"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133322"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-129" name="line-129"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-130" name="line-130"></a><span class="hs-comment">-- | Creates a input with @type=&quot;number&quot;@ and @step=any@.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-131" name="line-131"></a><span class="hs-identifier">doubleField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133317"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133317"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133317"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-132" name="line-132"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#doubleField" name="doubleField"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#doubleField"><span class="hs-identifier">doubleField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-133" name="line-133"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133339" name="local-6989586621679133339"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133339"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-134" name="line-134"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Data</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Text</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Read</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">double</span><span> </span><span class="hs-special">(</span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#prependZero"><span class="hs-identifier hs-var">prependZero</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133339"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-135" name="line-135"></a><span>            </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133340" name="local-6989586621679133340"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133340"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133340"><span class="hs-identifier hs-var">a</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-136" name="line-136"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#MsgInvalidNumber"><span class="hs-identifier hs-var">MsgInvalidNumber</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133339"><span class="hs-identifier hs-var">s</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-137" name="line-137"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-138" name="line-138"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133341" name="local-6989586621679133341"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133341"><span class="hs-identifier">theId</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133342" name="local-6989586621679133342"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133342"><span class="hs-identifier">name</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133343" name="local-6989586621679133343"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133343"><span class="hs-identifier">attrs</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133344" name="local-6989586621679133344"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133344"><span class="hs-identifier">val</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133345" name="local-6989586621679133345"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133345"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">hamlet</span><span class="hs-glyph">|</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-139" name="line-139"></a><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">newline</span><span> </span><span class="hs-identifier hs-var">never</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-140" name="line-140"></a><span class="hs-operator hs-var">&lt;</span><span class="hs-identifier hs-var">input</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{theId}&quot;</span><span> </span><span class="hs-identifier hs-var">name</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{name}&quot;</span><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">{</span><span class="hs-identifier hs-var">attrs</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">type</span><span class="hs-glyph">=</span><span class="hs-string">&quot;number&quot;</span><span> </span><span class="hs-identifier hs-var">step</span><span class="hs-glyph">=</span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">isReq</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">required</span><span class="hs-glyph">=</span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier hs-var">value</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{showVal val}&quot;</span><span class="hs-operator hs-var">&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-141" name="line-141"></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-142" name="line-142"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-143" name="line-143"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-144" name="line-144"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133338" name="local-6989586621679133338"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133338"><span class="hs-identifier">showVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-145" name="line-145"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-146" name="line-146"></a><span class="hs-comment">-- | Creates an input with @type=&quot;date&quot;@, validating the input using the 'parseDate' function.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-147" name="line-147"></a><span class="hs-comment">--</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-148" name="line-148"></a><span class="hs-comment">-- Add the @time@ package and import the &quot;Data.Time.Calendar&quot; module to use this function.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-149" name="line-149"></a><span class="hs-identifier">dayField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133316"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133316"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133316"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Day</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-150" name="line-150"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#dayField" name="dayField"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#dayField"><span class="hs-identifier">dayField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-151" name="line-151"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#parseDate"><span class="hs-identifier hs-var">parseDate</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unpack</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-152" name="line-152"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133352" name="local-6989586621679133352"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133352"><span class="hs-identifier">theId</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133353" name="local-6989586621679133353"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133353"><span class="hs-identifier">name</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133354" name="local-6989586621679133354"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133354"><span class="hs-identifier">attrs</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133355" name="local-6989586621679133355"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133355"><span class="hs-identifier">val</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133356" name="local-6989586621679133356"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133356"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">hamlet</span><span class="hs-glyph">|</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-153" name="line-153"></a><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">newline</span><span> </span><span class="hs-identifier hs-var">never</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-154" name="line-154"></a><span class="hs-operator hs-var">&lt;</span><span class="hs-identifier hs-var">input</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{theId}&quot;</span><span> </span><span class="hs-identifier hs-var">name</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{name}&quot;</span><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">{</span><span class="hs-identifier hs-var">attrs</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">type</span><span class="hs-glyph">=</span><span class="hs-string">&quot;date&quot;</span><span> </span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">isReq</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">required</span><span class="hs-glyph">=</span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier hs-var">value</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{showVal val}&quot;</span><span class="hs-operator hs-var">&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-155" name="line-155"></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-156" name="line-156"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-157" name="line-157"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-158" name="line-158"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133351" name="local-6989586621679133351"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133351"><span class="hs-identifier">showVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-159" name="line-159"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-160" name="line-160"></a><span class="hs-comment">-- | An alias for 'timeFieldTypeText'.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-161" name="line-161"></a><span class="hs-identifier">timeField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133315"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133315"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133315"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-162" name="line-162"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#timeField" name="timeField"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#timeField"><span class="hs-identifier">timeField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#timeFieldTypeText"><span class="hs-identifier hs-var">timeFieldTypeText</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-163" name="line-163"></a><span class="hs-pragma">{-# DEPRECATED timeField &quot;'timeField' currently defaults to an input of type=\&quot;text\&quot;. In the next major release, it will default to type=\&quot;time\&quot;. To opt in to the new functionality, use 'timeFieldTypeTime'. To keep the existing behavior, use 'timeFieldTypeText'. See 'https://github.com/yesodweb/yesod/pull/874' for details.&quot; #-}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-164" name="line-164"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-165" name="line-165"></a><span class="hs-comment">-- | Creates an input with @type=&quot;time&quot;@. &lt;http://caniuse.com/#search=time%20input%20type Browsers not supporting this type&gt; will fallback to a text field, and Yesod will parse the time as described in 'timeFieldTypeText'.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-166" name="line-166"></a><span class="hs-comment">-- </span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-167" name="line-167"></a><span class="hs-comment">-- Add the @time@ package and import the &quot;Data.Time.LocalTime&quot; module to use this function.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-168" name="line-168"></a><span class="hs-comment">--</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-169" name="line-169"></a><span class="hs-comment">-- Since 1.4.2</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-170" name="line-170"></a><span class="hs-identifier">timeFieldTypeTime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133314"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133314"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133314"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span>  </span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-171" name="line-171"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#timeFieldTypeTime" name="timeFieldTypeTime"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#timeFieldTypeTime"><span class="hs-identifier">timeFieldTypeTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#timeFieldOfType"><span class="hs-identifier hs-var">timeFieldOfType</span></a><span> </span><span class="hs-string">&quot;time&quot;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-172" name="line-172"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-173" name="line-173"></a><span class="hs-comment">-- | Creates an input with @type=&quot;text&quot;@, parsing the time from an [H]H:MM[:SS] format, with an optional AM or PM (if not given, AM is assumed for compatibility with the 24 hour clock system).</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-174" name="line-174"></a><span class="hs-comment">-- </span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-175" name="line-175"></a><span class="hs-comment">-- Add the @time@ package and import the &quot;Data.Time.LocalTime&quot; module to use this function.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-176" name="line-176"></a><span class="hs-comment">--</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-177" name="line-177"></a><span class="hs-comment">-- Since 1.4.2</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-178" name="line-178"></a><span class="hs-identifier">timeFieldTypeText</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133313"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133313"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133313"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-179" name="line-179"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#timeFieldTypeText" name="timeFieldTypeText"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#timeFieldTypeText"><span class="hs-identifier">timeFieldTypeText</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#timeFieldOfType"><span class="hs-identifier hs-var">timeFieldOfType</span></a><span> </span><span class="hs-string">&quot;text&quot;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-180" name="line-180"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-181" name="line-181"></a><span class="hs-identifier">timeFieldOfType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133312"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133312"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133312"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-182" name="line-182"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#timeFieldOfType" name="timeFieldOfType"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#timeFieldOfType"><span class="hs-identifier">timeFieldOfType</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133362" name="local-6989586621679133362"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133362"><span class="hs-identifier">inputType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-183" name="line-183"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#parseTime"><span class="hs-identifier hs-var">parseTime</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-184" name="line-184"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133367" name="local-6989586621679133367"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133367"><span class="hs-identifier">theId</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133368" name="local-6989586621679133368"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133368"><span class="hs-identifier">name</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133369" name="local-6989586621679133369"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133369"><span class="hs-identifier">attrs</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133370" name="local-6989586621679133370"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133370"><span class="hs-identifier">val</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133371" name="local-6989586621679133371"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133371"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">hamlet</span><span class="hs-glyph">|</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-185" name="line-185"></a><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">newline</span><span> </span><span class="hs-identifier hs-var">never</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-186" name="line-186"></a><span class="hs-operator hs-var">&lt;</span><span class="hs-identifier hs-var">input</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{theId}&quot;</span><span> </span><span class="hs-identifier hs-var">name</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{name}&quot;</span><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">{</span><span class="hs-identifier hs-var">attrs</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">type</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{inputType}&quot;</span><span> </span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">isReq</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">required</span><span class="hs-glyph">=</span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier hs-var">value</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{showVal val}&quot;</span><span class="hs-operator hs-var">&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-187" name="line-187"></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-188" name="line-188"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-189" name="line-189"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-190" name="line-190"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-191" name="line-191"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133363" name="local-6989586621679133363"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133363"><span class="hs-identifier">showVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133364"><span class="hs-identifier hs-var">roundFullSeconds</span></a><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-192" name="line-192"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133364" name="local-6989586621679133364"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133364"><span class="hs-identifier">roundFullSeconds</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133365" name="local-6989586621679133365"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133365"><span class="hs-identifier">tod</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-193" name="line-193"></a><span>        </span><span class="hs-identifier hs-var">TimeOfDay</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">todHour</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133365"><span class="hs-identifier hs-var">tod</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">todMin</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133365"><span class="hs-identifier hs-var">tod</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133366"><span class="hs-identifier hs-var">fullSec</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-194" name="line-194"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-195" name="line-195"></a><span>        </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133366" name="local-6989586621679133366"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133366"><span class="hs-identifier">fullSec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">floor</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">todSec</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133365"><span class="hs-identifier hs-var">tod</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-196" name="line-196"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-197" name="line-197"></a><span class="hs-comment">-- | Creates a @\&lt;textarea&gt;@ tag whose input is sanitized to prevent XSS attacks and is validated for having balanced tags.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-198" name="line-198"></a><span class="hs-identifier">htmlField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133311"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133311"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133311"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Html</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-199" name="line-199"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#htmlField" name="htmlField"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#htmlField"><span class="hs-identifier">htmlField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-200" name="line-200"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">preEscapedText</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">sanitizeBalance</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-201" name="line-201"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133378" name="local-6989586621679133378"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133378"><span class="hs-identifier">theId</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133379" name="local-6989586621679133379"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133379"><span class="hs-identifier">name</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133380" name="local-6989586621679133380"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133380"><span class="hs-identifier">attrs</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133381" name="local-6989586621679133381"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133381"><span class="hs-identifier">val</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133382" name="local-6989586621679133382"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133382"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">hamlet</span><span class="hs-glyph">|</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-202" name="line-202"></a><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">newline</span><span> </span><span class="hs-identifier hs-var">never</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-203" name="line-203"></a><span class="hs-operator hs-var">&lt;</span><span class="hs-identifier hs-var">textarea</span><span> </span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">isReq</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">required</span><span class="hs-glyph">=</span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{theId}&quot;</span><span> </span><span class="hs-identifier hs-var">name</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{name}&quot;</span><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">{</span><span class="hs-identifier hs-var">attrs</span><span class="hs-special">}</span><span class="hs-operator hs-var">&gt;#</span><span class="hs-special">{</span><span class="hs-identifier hs-var">showVal</span><span> </span><span class="hs-identifier hs-var">val</span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-204" name="line-204"></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-205" name="line-205"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-206" name="line-206"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-207" name="line-207"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133377" name="local-6989586621679133377"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133377"><span class="hs-identifier">showVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">renderHtml</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-208" name="line-208"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-209" name="line-209"></a><span class="hs-comment">-- | A newtype wrapper around a 'Text' whose 'ToMarkup' instance converts newlines to HTML @\&lt;br&gt;@ tags.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-210" name="line-210"></a><span class="hs-comment">-- </span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-211" name="line-211"></a><span class="hs-comment">-- (When text is entered into a @\&lt;textarea&gt;@, newline characters are used to separate lines.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-212" name="line-212"></a><span class="hs-comment">-- If this text is then placed verbatim into HTML, the lines won't be separated, thus the need for replacing with @\&lt;br&gt;@ tags).</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-213" name="line-213"></a><span class="hs-comment">-- If you don't need this functionality, simply use 'unTextarea' to access the raw text.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-214" name="line-214"></a><span class="hs-keyword">newtype</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#Textarea" name="Textarea"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#Textarea"><span class="hs-identifier">Textarea</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#Textarea" name="Textarea"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#Textarea"><span class="hs-identifier">Textarea</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#unTextarea" name="unTextarea"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#unTextarea"><span class="hs-identifier">unTextarea</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-215" name="line-215"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PersistField</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-216" name="line-216"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">PersistFieldSql</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#Textarea"><span class="hs-identifier hs-type">Textarea</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-217" name="line-217"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-8214565720323806445" name="local-8214565720323806445"><span class="hs-identifier">sqlType</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">SqlString</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-218" name="line-218"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToHtml</span><span> </span><span class="hs-identifier">Textarea</span><span> </span><span class="hs-keyword">where</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-219" name="line-219"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-8214565720323793191" name="local-8214565720323793191"><span class="hs-identifier">toHtml</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-220" name="line-220"></a><span>        </span><span class="hs-identifier hs-var">unsafeByteString</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-221" name="line-221"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">S</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">concat</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-222" name="line-222"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toChunks</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-223" name="line-223"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toLazyByteString</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-224" name="line-224"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromWriteList</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133912"><span class="hs-identifier hs-var">writeHtmlEscapedChar</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-225" name="line-225"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unpack</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-226" name="line-226"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unTextarea</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-227" name="line-227"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-228" name="line-228"></a><span>        </span><span class="hs-comment">-- Taken from blaze-builder and modified with newline handling.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-229" name="line-229"></a><span>        </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133912" name="local-6989586621679133912"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133912"><span class="hs-identifier">writeHtmlEscapedChar</span></a></a><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">writeByteString</span><span> </span><span class="hs-string">&quot;&lt;br&gt;&quot;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-230" name="line-230"></a><span>        </span><span class="hs-identifier">writeHtmlEscapedChar</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133928" name="local-6989586621679133928"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133928"><span class="hs-identifier">c</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">writeHtmlEscapedChar</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133928"><span class="hs-identifier hs-var">c</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-231" name="line-231"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-232" name="line-232"></a><span class="hs-comment">-- | Creates a @\&lt;textarea&gt;@ tag whose returned value is wrapped in a 'Textarea'; see 'Textarea' for details.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-233" name="line-233"></a><span class="hs-identifier">textareaField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133310"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133310"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133310"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#Textarea"><span class="hs-identifier hs-type">Textarea</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-234" name="line-234"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#textareaField" name="textareaField"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#textareaField"><span class="hs-identifier">textareaField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-235" name="line-235"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#Textarea"><span class="hs-identifier hs-var">Textarea</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-236" name="line-236"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133388" name="local-6989586621679133388"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133388"><span class="hs-identifier">theId</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133389" name="local-6989586621679133389"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133389"><span class="hs-identifier">name</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133390" name="local-6989586621679133390"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133390"><span class="hs-identifier">attrs</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133391" name="local-6989586621679133391"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133391"><span class="hs-identifier">val</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133392" name="local-6989586621679133392"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133392"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">hamlet</span><span class="hs-glyph">|</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-237" name="line-237"></a><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">newline</span><span> </span><span class="hs-identifier hs-var">never</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-238" name="line-238"></a><span class="hs-operator hs-var">&lt;</span><span class="hs-identifier hs-var">textarea</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{theId}&quot;</span><span> </span><span class="hs-identifier hs-var">name</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{name}&quot;</span><span> </span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">isReq</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">required</span><span class="hs-glyph">=</span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">{</span><span class="hs-identifier hs-var">attrs</span><span class="hs-special">}</span><span class="hs-operator hs-var">&gt;#</span><span class="hs-special">{</span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-identifier hs-var">unTextarea</span><span> </span><span class="hs-identifier hs-var">val</span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-239" name="line-239"></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-240" name="line-240"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-241" name="line-241"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-242" name="line-242"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-243" name="line-243"></a><span class="hs-comment">-- | Creates an input with @type=&quot;hidden&quot;@; you can use this to store information in a form that users shouldn't see (for example, Yesod stores CSRF tokens in a hidden field).</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-244" name="line-244"></a><span class="hs-identifier">hiddenField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133308"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PathPiece</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133309"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133308"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-245" name="line-245"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133308"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133309"><span class="hs-identifier hs-type">p</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-246" name="line-246"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#hiddenField" name="hiddenField"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#hiddenField"><span class="hs-identifier">hiddenField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-247" name="line-247"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#MsgValueRequired"><span class="hs-identifier hs-var">MsgValueRequired</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromPathPiece</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-248" name="line-248"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133398" name="local-6989586621679133398"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133398"><span class="hs-identifier">theId</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133399" name="local-6989586621679133399"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133399"><span class="hs-identifier">name</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133400" name="local-6989586621679133400"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133400"><span class="hs-identifier">attrs</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133401" name="local-6989586621679133401"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133401"><span class="hs-identifier">val</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133402" name="local-6989586621679133402"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133402"><span class="hs-identifier">_isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">hamlet</span><span class="hs-glyph">|</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-249" name="line-249"></a><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">newline</span><span> </span><span class="hs-identifier hs-var">never</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-250" name="line-250"></a><span class="hs-operator hs-var">&lt;</span><span class="hs-identifier hs-var">input</span><span> </span><span class="hs-keyword">type</span><span class="hs-glyph">=</span><span class="hs-string">&quot;hidden&quot;</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{theId}&quot;</span><span> </span><span class="hs-identifier hs-var">name</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{name}&quot;</span><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">{</span><span class="hs-identifier hs-var">attrs</span><span class="hs-special">}</span><span> </span><span class="hs-identifier hs-var">value</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{either id toPathPiece val}&quot;</span><span class="hs-operator hs-var">&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-251" name="line-251"></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-252" name="line-252"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-253" name="line-253"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-254" name="line-254"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-255" name="line-255"></a><span class="hs-comment">-- | Creates a input with @type=&quot;text&quot;@.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-256" name="line-256"></a><span class="hs-identifier">textField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133307"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133307"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133307"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-257" name="line-257"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#textField" name="textField"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#textField"><span class="hs-identifier">textField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-258" name="line-258"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Right</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-259" name="line-259"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133408" name="local-6989586621679133408"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133408"><span class="hs-identifier">theId</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133409" name="local-6989586621679133409"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133409"><span class="hs-identifier">name</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133410" name="local-6989586621679133410"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133410"><span class="hs-identifier">attrs</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133411" name="local-6989586621679133411"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133411"><span class="hs-identifier">val</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133412" name="local-6989586621679133412"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133412"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-260" name="line-260"></a><span>        </span><span class="hs-special">[</span><span class="hs-identifier">whamlet</span><span class="hs-glyph">|</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-261" name="line-261"></a><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">newline</span><span> </span><span class="hs-identifier hs-var">never</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-262" name="line-262"></a><span class="hs-operator hs-var">&lt;</span><span class="hs-identifier hs-var">input</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{theId}&quot;</span><span> </span><span class="hs-identifier hs-var">name</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{name}&quot;</span><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">{</span><span class="hs-identifier hs-var">attrs</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">type</span><span class="hs-glyph">=</span><span class="hs-string">&quot;text&quot;</span><span> </span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">isReq</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">required</span><span> </span><span class="hs-identifier hs-var">value</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{either id id val}&quot;</span><span class="hs-operator hs-var">&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-263" name="line-263"></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-264" name="line-264"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-265" name="line-265"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-266" name="line-266"></a><span class="hs-comment">-- | Creates an input with @type=&quot;password&quot;@.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-267" name="line-267"></a><span class="hs-identifier">passwordField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133306"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133306"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133306"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-268" name="line-268"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#passwordField" name="passwordField"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#passwordField"><span class="hs-identifier">passwordField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-269" name="line-269"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Right</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-270" name="line-270"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133417" name="local-6989586621679133417"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133417"><span class="hs-identifier">theId</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133418" name="local-6989586621679133418"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133418"><span class="hs-identifier">name</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133419" name="local-6989586621679133419"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133419"><span class="hs-identifier">attrs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133420" name="local-6989586621679133420"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133420"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">hamlet</span><span class="hs-glyph">|</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-271" name="line-271"></a><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">newline</span><span> </span><span class="hs-identifier hs-var">never</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-272" name="line-272"></a><span class="hs-operator hs-var">&lt;</span><span class="hs-identifier hs-var">input</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{theId}&quot;</span><span> </span><span class="hs-identifier hs-var">name</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{name}&quot;</span><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">{</span><span class="hs-identifier hs-var">attrs</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">type</span><span class="hs-glyph">=</span><span class="hs-string">&quot;password&quot;</span><span> </span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">isReq</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">required</span><span class="hs-glyph">=</span><span class="hs-string">&quot;&quot;</span><span class="hs-operator hs-var">&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-273" name="line-273"></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-274" name="line-274"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-275" name="line-275"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-276" name="line-276"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-277" name="line-277"></a><span class="hs-identifier">readMay</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133305"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133305"><span class="hs-identifier hs-type">a</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-278" name="line-278"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#readMay" name="readMay"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#readMay"><span class="hs-identifier">readMay</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133426" name="local-6989586621679133426"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133426"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Prelude</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reads</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133426"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-279" name="line-279"></a><span>                </span><span class="hs-special">(</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133447" name="local-6989586621679133447"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133447"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133447"><span class="hs-identifier hs-var">x</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-280" name="line-280"></a><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-281" name="line-281"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-282" name="line-282"></a><span class="hs-comment">-- | Parses a 'Day' from a 'String'.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-283" name="line-283"></a><span class="hs-identifier">parseDate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-identifier hs-type">Day</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-284" name="line-284"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#parseDate" name="parseDate"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#parseDate"><span class="hs-identifier">parseDate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#MsgInvalidDay"><span class="hs-identifier hs-var">MsgInvalidDay</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Right</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-285" name="line-285"></a><span>              </span><span class="hs-operator hs-var">.</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#readMay"><span class="hs-identifier hs-var">readMay</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#replace"><span class="hs-identifier hs-var">replace</span></a><span> </span><span class="hs-char">'/'</span><span> </span><span class="hs-char">'-'</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-286" name="line-286"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-287" name="line-287"></a><span class="hs-comment">-- | Replaces all instances of a value in a list by another value.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-288" name="line-288"></a><span class="hs-comment">-- from http://hackage.haskell.org/packages/archive/cgi/3001.1.7.1/doc/html/src/Network-CGI-Protocol.html#replace</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-289" name="line-289"></a><span class="hs-identifier">replace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133304"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133304"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133304"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133304"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133304"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-290" name="line-290"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#replace" name="replace"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#replace"><span class="hs-identifier">replace</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133448" name="local-6989586621679133448"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133448"><span class="hs-identifier">x</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133449" name="local-6989586621679133449"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133449"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133450" name="local-6989586621679133450"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133450"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133450"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133448"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133449"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133450"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-291" name="line-291"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-292" name="line-292"></a><span class="hs-identifier">parseTime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-293" name="line-293"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#parseTime" name="parseTime"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#parseTime"><span class="hs-identifier">parseTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#MsgInvalidTimeFormat"><span class="hs-identifier hs-var">MsgInvalidTimeFormat</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#readMay"><span class="hs-identifier hs-var">readMay</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-char">':'</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">parseOnly</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#timeParser"><span class="hs-identifier hs-var">timeParser</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-294" name="line-294"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-295" name="line-295"></a><span class="hs-identifier">timeParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-296" name="line-296"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#timeParser" name="timeParser"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#timeParser"><span class="hs-identifier">timeParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-297" name="line-297"></a><span>    </span><span class="hs-identifier hs-var">skipSpace</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-298" name="line-298"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133463" name="local-6989586621679133463"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133463"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133451"><span class="hs-identifier hs-var">hour</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-299" name="line-299"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">':'</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-300" name="line-300"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133464" name="local-6989586621679133464"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133464"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133452"><span class="hs-identifier hs-var">minsec</span></a><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#MsgInvalidMinute"><span class="hs-identifier hs-var">MsgInvalidMinute</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-301" name="line-301"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133465" name="local-6989586621679133465"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133465"><span class="hs-identifier">hasSec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">':'</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-302" name="line-302"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133466" name="local-6989586621679133466"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133466"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133465"><span class="hs-identifier hs-var">hasSec</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133452"><span class="hs-identifier hs-var">minsec</span></a><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#MsgInvalidSecond"><span class="hs-identifier hs-var">MsgInvalidSecond</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-number">0</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-303" name="line-303"></a><span>    </span><span class="hs-identifier hs-var">skipSpace</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-304" name="line-304"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133467" name="local-6989586621679133467"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133467"><span class="hs-identifier">isPM</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-305" name="line-305"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;am&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-306" name="line-306"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;AM&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-307" name="line-307"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;pm&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-308" name="line-308"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;PM&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-309" name="line-309"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-310" name="line-310"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133469" name="local-6989586621679133469"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133469"><span class="hs-identifier">h'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-311" name="line-311"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133467"><span class="hs-identifier hs-var">isPM</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-312" name="line-312"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133463"><span class="hs-identifier hs-var">h</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-313" name="line-313"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133468" name="local-6989586621679133468"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133468"><span class="hs-identifier">x</span></a></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-314" name="line-314"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133463"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133463"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">12</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#MsgInvalidHour"><span class="hs-identifier hs-var">MsgInvalidHour</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133463"><span class="hs-identifier hs-var">h</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-315" name="line-315"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133463"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">12</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133468"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">12</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-316" name="line-316"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133463"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133468"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">12</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-317" name="line-317"></a><span>    </span><span class="hs-identifier hs-var">skipSpace</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-318" name="line-318"></a><span>    </span><span class="hs-identifier hs-var">endOfInput</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-319" name="line-319"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TimeOfDay</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133469"><span class="hs-identifier hs-var">h'</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133464"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133466"><span class="hs-identifier hs-var">s</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-320" name="line-320"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-321" name="line-321"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133451" name="local-6989586621679133451"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133451"><span class="hs-identifier">hour</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-322" name="line-322"></a><span>        </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133454" name="local-6989586621679133454"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133454"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">digit</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-323" name="line-323"></a><span>        </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133455" name="local-6989586621679133455"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133455"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Control</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Applicative</span><span class="hs-operator hs-var">.&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">digit</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-324" name="line-324"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133456" name="local-6989586621679133456"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133456"><span class="hs-identifier">xy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133454"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133455"><span class="hs-identifier hs-var">y</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-325" name="line-325"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133457" name="local-6989586621679133457"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133457"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">read</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133456"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-326" name="line-326"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133457"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133457"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">24</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-327" name="line-327"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#MsgInvalidHour"><span class="hs-identifier hs-var">MsgInvalidHour</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133456"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-328" name="line-328"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133457"><span class="hs-identifier hs-var">i</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-329" name="line-329"></a><span>    </span><span class="hs-identifier">minsec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133453"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133453"><span class="hs-identifier hs-type">a</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-330" name="line-330"></a><span>    </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133452" name="local-6989586621679133452"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133452"><span class="hs-identifier">minsec</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133458" name="local-6989586621679133458"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133458"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-331" name="line-331"></a><span>        </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133459" name="local-6989586621679133459"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133459"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">digit</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-332" name="line-332"></a><span>        </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133460" name="local-6989586621679133460"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133460"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">digit</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133458"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-special">[</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133459"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-333" name="line-333"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133461" name="local-6989586621679133461"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133461"><span class="hs-identifier">xy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133459"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133460"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-334" name="line-334"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133462" name="local-6989586621679133462"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133462"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">read</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133461"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-335" name="line-335"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133462"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133462"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">60</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-336" name="line-336"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133458"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133461"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-337" name="line-337"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133462"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-338" name="line-338"></a><span>            </span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-339" name="line-339"></a><span class="hs-comment">-- | Creates an input with @type=&quot;email&quot;@. Yesod will validate the email's correctness according to RFC5322 and canonicalize it by removing comments and whitespace (see &quot;Text.Email.Validate&quot;).</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-340" name="line-340"></a><span class="hs-identifier">emailField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133101"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133101"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133101"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-341" name="line-341"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#emailField" name="emailField"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#emailField"><span class="hs-identifier">emailField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-342" name="line-342"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-343" name="line-343"></a><span>        </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133562" name="local-6989586621679133562"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133562"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-344" name="line-344"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Email</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">canonicalizeEmail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">encodeUtf8</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133562"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-345" name="line-345"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133563" name="local-6989586621679133563"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133563"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">decodeUtf8With</span><span> </span><span class="hs-identifier hs-var">lenientDecode</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133563"><span class="hs-identifier hs-var">e</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-346" name="line-346"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#MsgInvalidEmail"><span class="hs-identifier hs-var">MsgInvalidEmail</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133562"><span class="hs-identifier hs-var">s</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-347" name="line-347"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133564" name="local-6989586621679133564"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133564"><span class="hs-identifier">theId</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133565" name="local-6989586621679133565"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133565"><span class="hs-identifier">name</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133566" name="local-6989586621679133566"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133566"><span class="hs-identifier">attrs</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133567" name="local-6989586621679133567"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133567"><span class="hs-identifier">val</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133568" name="local-6989586621679133568"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133568"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">hamlet</span><span class="hs-glyph">|</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-348" name="line-348"></a><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">newline</span><span> </span><span class="hs-identifier hs-var">never</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-349" name="line-349"></a><span class="hs-operator hs-var">&lt;</span><span class="hs-identifier hs-var">input</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{theId}&quot;</span><span> </span><span class="hs-identifier hs-var">name</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{name}&quot;</span><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">{</span><span class="hs-identifier hs-var">attrs</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">type</span><span class="hs-glyph">=</span><span class="hs-string">&quot;email&quot;</span><span> </span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">isReq</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">required</span><span class="hs-glyph">=</span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier hs-var">value</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{either id id val}&quot;</span><span class="hs-operator hs-var">&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-350" name="line-350"></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-351" name="line-351"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-352" name="line-352"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-353" name="line-353"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-354" name="line-354"></a><span class="hs-comment">-- | Creates an input with @type=&quot;email&quot;@ with the &lt;http://w3c.github.io/html/sec-forms.html#the-multiple-attribute multiple&gt; attribute; browsers might implement this as taking a comma separated list of emails. Each email address is validated as described in 'emailField'.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-355" name="line-355"></a><span class="hs-comment">--</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-356" name="line-356"></a><span class="hs-comment">-- Since 1.3.7</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-357" name="line-357"></a><span class="hs-identifier">multiEmailField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133100"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133100"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133100"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-358" name="line-358"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#multiEmailField" name="multiEmailField"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#multiEmailField"><span class="hs-identifier">multiEmailField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-359" name="line-359"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-360" name="line-360"></a><span>        </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133580" name="local-6989586621679133580"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133580"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-361" name="line-361"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133581" name="local-6989586621679133581"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133581"><span class="hs-identifier">addrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133574"><span class="hs-identifier hs-var">validate</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">splitOn</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133580"><span class="hs-identifier hs-var">s</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-362" name="line-362"></a><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">partitionEithers</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133581"><span class="hs-identifier hs-var">addrs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-363" name="line-363"></a><span>                </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133582" name="local-6989586621679133582"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133582"><span class="hs-identifier">good</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133582"><span class="hs-identifier hs-var">good</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-364" name="line-364"></a><span>                </span><span class="hs-special">(</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133583" name="local-6989586621679133583"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133583"><span class="hs-identifier">bad</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#MsgInvalidEmail"><span class="hs-identifier hs-var">MsgInvalidEmail</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133575"><span class="hs-identifier hs-var">cat</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133583"><span class="hs-identifier hs-var">bad</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-365" name="line-365"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133584" name="local-6989586621679133584"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133584"><span class="hs-identifier">theId</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133585" name="local-6989586621679133585"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133585"><span class="hs-identifier">name</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133586" name="local-6989586621679133586"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133586"><span class="hs-identifier">attrs</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133587" name="local-6989586621679133587"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133587"><span class="hs-identifier">val</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133588" name="local-6989586621679133588"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133588"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">hamlet</span><span class="hs-glyph">|</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-366" name="line-366"></a><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">newline</span><span> </span><span class="hs-identifier hs-var">never</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-367" name="line-367"></a><span class="hs-operator hs-var">&lt;</span><span class="hs-identifier hs-var">input</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{theId}&quot;</span><span> </span><span class="hs-identifier hs-var">name</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{name}&quot;</span><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">{</span><span class="hs-identifier hs-var">attrs</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">type</span><span class="hs-glyph">=</span><span class="hs-string">&quot;email&quot;</span><span> </span><span class="hs-identifier hs-var">multiple</span><span> </span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">isReq</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">required</span><span class="hs-glyph">=</span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier hs-var">value</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{either id cat val}&quot;</span><span class="hs-operator hs-var">&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-368" name="line-368"></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-369" name="line-369"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-370" name="line-370"></a><span>    </span><span class="hs-special">}</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-371" name="line-371"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-372" name="line-372"></a><span>        </span><span class="hs-comment">-- report offending address along with error</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-373" name="line-373"></a><span>        </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133574" name="local-6989586621679133574"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133574"><span class="hs-identifier">validate</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133577" name="local-6989586621679133577"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133577"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Email</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">validate</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">encodeUtf8</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133577"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-374" name="line-374"></a><span>                        </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133578" name="local-6989586621679133578"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133578"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133577"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; (&quot;</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">pack</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133578"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-375" name="line-375"></a><span>                        </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133579" name="local-6989586621679133579"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133579"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133576"><span class="hs-identifier hs-var">emailToText</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133579"><span class="hs-identifier hs-var">r</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-376" name="line-376"></a><span>        </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133575" name="local-6989586621679133575"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133575"><span class="hs-identifier">cat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;, &quot;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-377" name="line-377"></a><span>        </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133576" name="local-6989586621679133576"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133576"><span class="hs-identifier">emailToText</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">decodeUtf8With</span><span> </span><span class="hs-identifier hs-var">lenientDecode</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Email</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toByteString</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-378" name="line-378"></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-379" name="line-379"></a><span class="hs-keyword">type</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#AutoFocus" name="AutoFocus"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#AutoFocus"><span class="hs-identifier">AutoFocus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-380" name="line-380"></a><span class="hs-comment">-- | Creates an input with @type=&quot;search&quot;@. For &lt;http://caniuse.com/#search=autofocus browsers without autofocus support&gt;, a JS fallback is used if @AutoFocus@ is true.</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-381" name="line-381"></a><span class="hs-identifier">searchField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133099"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133099"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#AutoFocus"><span class="hs-identifier hs-type">AutoFocus</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133099"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-382" name="line-382"></a><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#searchField" name="searchField"><a href="../yesod-form-1.4.12/Yesod.Form.Fields.html#searchField"><span class="hs-identifier">searchField</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133594" name="local-6989586621679133594"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133594"><span class="hs-identifier">autoFocus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-383" name="line-383"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../yesod-form-1.4.12/Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-identifier hs-var">Right</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-384" name="line-384"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133595" name="local-6989586621679133595"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133595"><span class="hs-identifier">theId</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133596" name="local-6989586621679133596"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133596"><span class="hs-identifier">name</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133597" name="local-6989586621679133597"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133597"><span class="hs-identifier">attrs</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133598" name="local-6989586621679133598"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133598"><span class="hs-identifier">val</span></a></a><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133599" name="local-6989586621679133599"><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133599"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-385" name="line-385"></a><span>        </span><span class="hs-special">[</span><span class="hs-identifier">whamlet</span><span class="hs-glyph">|</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-386" name="line-386"></a><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">newline</span><span> </span><span class="hs-identifier hs-var">never</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-387" name="line-387"></a><span class="hs-operator hs-var">&lt;</span><span class="hs-identifier hs-var">input</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{theId}&quot;</span><span> </span><span class="hs-identifier hs-var">name</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{name}&quot;</span><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">{</span><span class="hs-identifier hs-var">attrs</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">type</span><span class="hs-glyph">=</span><span class="hs-string">&quot;search&quot;</span><span> </span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">isReq</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">required</span><span class="hs-glyph">=</span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">autoFocus</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">autofocus</span><span class="hs-glyph">=</span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier hs-var">value</span><span class="hs-glyph">=</span><span class="hs-string">&quot;#{either id id val}&quot;</span><span class="hs-operator hs-var">&gt;</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-388" name="line-388"></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-389" name="line-389"></a><span>        </span><span class="hs-identifier hs-var">when</span><span> </span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#local-6989586621679133594"><span class="hs-identifier hs-var">autoFocus</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-390" name="line-390"></a><span>          </span><span class="hs-comment">-- we want this javascript to be placed immediately after the field</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-391" name="line-391"></a><span>          </span><span class="hs-special">[</span><span class="hs-identifier">whamlet</span><span class="hs-glyph">|</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-392" name="line-392"></a><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">newline</span><span> </span><span class="hs-identifier hs-var">never</span><span>
</span><a href="../yesod-form-1.4.12/src/Yesod.Form.Fields.html#line-393" name="line-393"></a><span class="hs-operator hs-var">&lt;</span><span class="hs-identifier hs-var">script</span><span class="hs-operator hs-var">&gt;</span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-char">'autofocus' in document.createElement('input'))) {document.getElementById('#{theId}').focus();}
|]
          toWidget [cassius|
            ##{theId}
              -webkit-appearance: textfield
            |]
    , fieldEnctype = UrlEncoded
    }
-- | Creates an input with @type=&quot;url&quot;@, validating the URL according to RFC3986.
urlField :: Monad m =&gt; RenderMessage (HandlerSite m) FormMessage =&gt; Field m Text
urlField = Field
    { fieldParse = parseHelper $ \s -&gt;
        case parseURI $ unpack s of
            Nothing -&gt; Left $ MsgInvalidUrl s
            Just _ -&gt; Right s
    , fieldView = \theId name attrs val isReq -&gt;
        [whamlet|&lt;input ##{theId} name=#{name} *{attrs} type=url :isReq:required value=#{either id id val}&gt;|]
    , fieldEnctype = UrlEncoded
    }

-- | Creates a @\&lt;select&gt;@ tag for selecting one option. Example usage:
--
-- &gt; areq (selectFieldList [(&quot;Value 1&quot; :: Text, &quot;value1&quot;),(&quot;Value 2&quot;, &quot;value2&quot;)]) &quot;Which value?&quot; Nothing
selectFieldList :: (Eq a, RenderMessage site FormMessage, RenderMessage site msg)
                =&gt; [(msg, a)]
                -&gt; Field (HandlerT site IO) a
selectFieldList = selectField . optionsPairs

-- | Creates a @\&lt;select&gt;@ tag for selecting one option. Example usage:
--
-- &gt; areq (selectField $ optionsPairs [(MsgValue1, &quot;value1&quot;),(MsgValue2, &quot;value2&quot;)]) &quot;Which value?&quot; Nothing
selectField :: (Eq a, RenderMessage site FormMessage)
            =&gt; HandlerT site IO (OptionList a)
            -&gt; Field (HandlerT site IO) a
selectField = selectFieldHelper
    (\theId name attrs inside -&gt; [whamlet|
$newline never
&lt;select ##{theId} name=#{name} *{attrs}&gt;^{inside}
|]) -- outside
    (\_theId _name isSel -&gt; [whamlet|
$newline never
&lt;option value=none :isSel:selected&gt;_{MsgSelectNone}
|]) -- onOpt
    (\_theId _name _attrs value isSel text -&gt; [whamlet|
$newline never
&lt;option value=#{value} :isSel:selected&gt;#{text}
|]) -- inside

-- | Creates a @\&lt;select&gt;@ tag for selecting multiple options.
multiSelectFieldList :: (Eq a, RenderMessage site msg)
                     =&gt; [(msg, a)]
                     -&gt; Field (HandlerT site IO) [a]
multiSelectFieldList = multiSelectField . optionsPairs

-- | Creates a @\&lt;select&gt;@ tag for selecting multiple options.
multiSelectField :: Eq a
                 =&gt; HandlerT site IO (OptionList a)
                 -&gt; Field (HandlerT site IO) [a]
multiSelectField ioptlist =
    Field parse view UrlEncoded
  where
    parse [] _ = return $ Right Nothing
    parse optlist _ = do
        mapopt &lt;- olReadExternal &lt;$&gt; ioptlist
        case mapM mapopt optlist of
             Nothing -&gt; return $ Left &quot;Error parsing values&quot;
             Just res -&gt; return $ Right $ Just res

    view theId name attrs val isReq = do
        opts &lt;- fmap olOptions $ handlerToWidget ioptlist
        let selOpts = map (id &amp;&amp;&amp; (optselected val)) opts
        [whamlet|
            &lt;select ##{theId} name=#{name} :isReq:required multiple *{attrs}&gt;
                $forall (opt, optsel) &lt;- selOpts
                    &lt;option value=#{optionExternalValue opt} :optsel:selected&gt;#{optionDisplay opt}
                |]
        where
            optselected (Left _) _ = False
            optselected (Right vals) opt = (optionInternalValue opt) `elem` vals

-- | Creates an input with @type=&quot;radio&quot;@ for selecting one option.
radioFieldList :: (Eq a, RenderMessage site FormMessage, RenderMessage site msg)
               =&gt; [(msg, a)]
               -&gt; Field (HandlerT site IO) a
radioFieldList = radioField . optionsPairs

-- | Creates an input with @type=&quot;checkbox&quot;@ for selecting multiple options.
checkboxesFieldList :: (Eq a, RenderMessage site msg) =&gt; [(msg, a)]
                     -&gt; Field (HandlerT site IO) [a]
checkboxesFieldList = checkboxesField . optionsPairs

-- | Creates an input with @type=&quot;checkbox&quot;@ for selecting multiple options.
checkboxesField :: Eq a
                 =&gt; HandlerT site IO (OptionList a)
                 -&gt; Field (HandlerT site IO) [a]
checkboxesField ioptlist = (multiSelectField ioptlist)
    { fieldView =
        \theId name attrs val _isReq -&gt; do
            opts &lt;- fmap olOptions $ handlerToWidget ioptlist
            let optselected (Left _) _ = False
                optselected (Right vals) opt = (optionInternalValue opt) `elem` vals
            [whamlet|
                &lt;span ##{theId}&gt;
                    $forall opt &lt;- opts
                        &lt;label&gt;
                            &lt;input type=checkbox name=#{name} value=#{optionExternalValue opt} *{attrs} :optselected val opt:checked&gt;
                            #{optionDisplay opt}
                |]
    }
-- | Creates an input with @type=&quot;radio&quot;@ for selecting one option.
radioField :: (Eq a, RenderMessage site FormMessage)
           =&gt; HandlerT site IO (OptionList a)
           -&gt; Field (HandlerT site IO) a
radioField = selectFieldHelper
    (\theId _name _attrs inside -&gt; [whamlet|
$newline never
&lt;div ##{theId}&gt;^{inside}
|])
    (\theId name isSel -&gt; [whamlet|
$newline never
&lt;label .radio for=#{theId}-none&gt;
    &lt;div&gt;
        &lt;input id=#{theId}-none type=radio name=#{name} value=none :isSel:checked&gt;
        _{MsgSelectNone}
|])
    (\theId name attrs value isSel text -&gt; [whamlet|
$newline never
&lt;label .radio for=#{theId}-#{value}&gt;
    &lt;div&gt;
        &lt;input id=#{theId}-#{value} type=radio name=#{name} value=#{value} :isSel:checked *{attrs}&gt;
        \#{text}
|])

-- | Creates a group of radio buttons to answer the question given in the message. Radio buttons are used to allow differentiating between an empty response (@Nothing@) and a no response (@Just False@). Consider using the simpler 'checkBoxField' if you don't need to make this distinction.
--
-- If this field is optional, the first radio button is labeled &quot;\&lt;None&gt;&quot;, the second \&quot;Yes&quot; and the third \&quot;No&quot;.
--
-- If this field is required, the first radio button is labeled \&quot;Yes&quot; and the second \&quot;No&quot;. 
--
-- (Exact label titles will depend on localization).
boolField :: Monad m =&gt; RenderMessage (HandlerSite m) FormMessage =&gt; Field m Bool
boolField = Field
      { fieldParse = \e _ -&gt; return $ boolParser e
      , fieldView = \theId name attrs val isReq -&gt; [whamlet|
$newline never
  $if not isReq
      &lt;input id=#{theId}-none *{attrs} type=radio name=#{name} value=none checked&gt;
      &lt;label for=#{theId}-none&gt;_{MsgSelectNone}


&lt;input id=#{theId}-yes *{attrs} type=radio name=#{name} value=yes :showVal id val:checked&gt;
&lt;label for=#{theId}-yes&gt;_{MsgBoolYes}

&lt;input id=#{theId}-no *{attrs} type=radio name=#{name} value=no :showVal not val:checked&gt;
&lt;label for=#{theId}-no&gt;_{MsgBoolNo}
|]
    , fieldEnctype = UrlEncoded
    }
  where
    boolParser [] = Right Nothing
    boolParser (x:_) = case x of
      &quot;&quot; -&gt; Right Nothing
      &quot;none&quot; -&gt; Right Nothing
      &quot;yes&quot; -&gt; Right $ Just True
      &quot;on&quot; -&gt; Right $ Just True
      &quot;no&quot; -&gt; Right $ Just False
      &quot;true&quot; -&gt; Right $ Just True
      &quot;false&quot; -&gt; Right $ Just False
      t -&gt; Left $ SomeMessage $ MsgInvalidBool t
    showVal = either (\_ -&gt; False)

-- | Creates an input with @type=&quot;checkbox&quot;@. 
--   While the default @'boolField'@ implements a radio button so you
--   can differentiate between an empty response (@Nothing@) and a no
--   response (@Just False@), this simpler checkbox field returns an empty
--   response as @Just False@.
--
--   Note that this makes the field always optional.
--
checkBoxField :: Monad m =&gt; Field m Bool
checkBoxField = Field
    { fieldParse = \e _ -&gt; return $ checkBoxParser e
    , fieldView  = \theId name attrs val _ -&gt; [whamlet|
$newline never
&lt;input id=#{theId} *{attrs} type=checkbox name=#{name} value=yes :showVal id val:checked&gt;
|]
    , fieldEnctype = UrlEncoded
    }

    where
        checkBoxParser [] = Right $ Just False
        checkBoxParser (x:_) = case x of
            &quot;yes&quot; -&gt; Right $ Just True
            &quot;on&quot; -&gt; Right $ Just True
            _     -&gt; Right $ Just False

        showVal = either (\_ -&gt; False)

-- | A structure holding a list of options. Typically you can use a convenience function like 'mkOptionList' or 'optionsPairs' instead of creating this directly.
data OptionList a = OptionList
    { olOptions :: [Option a]
    , olReadExternal :: Text -&gt; Maybe a -- ^ A function mapping from the form's value ('optionExternalValue') to the selected Haskell value ('optionInternalValue').
    }

-- | Since 1.4.6
instance Functor OptionList where
    fmap f (OptionList options readExternal) = 
      OptionList ((fmap.fmap) f options) (fmap f . readExternal)

-- | Creates an 'OptionList', using a 'Map' to implement the 'olReadExternal' function.
mkOptionList :: [Option a] -&gt; OptionList a
mkOptionList os = OptionList
    { olOptions = os
    , olReadExternal = flip Map.lookup $ Map.fromList $ map (optionExternalValue &amp;&amp;&amp; optionInternalValue) os
    }

data Option a = Option
    { optionDisplay :: Text -- ^ The user-facing label.
    , optionInternalValue :: a -- ^ The Haskell value being selected.
    , optionExternalValue :: Text -- ^ The representation of this value stored in the form.
    }

-- | Since 1.4.6
instance Functor Option where
    fmap f (Option display internal external) = Option display (f internal) external

-- | Creates an 'OptionList' from a list of (display-value, internal value) pairs.
optionsPairs :: (MonadHandler m, RenderMessage (HandlerSite m) msg)
             =&gt; [(msg, a)] -&gt; m (OptionList a)
optionsPairs opts = do
  mr &lt;- getMessageRender
  let mkOption external (display, internal) =
          Option { optionDisplay       = mr display
                 , optionInternalValue = internal
                 , optionExternalValue = pack $ show external
                 }
  return $ mkOptionList (zipWith mkOption [1 :: Int ..] opts)

-- | Creates an 'OptionList' from an 'Enum', using its 'Show' instance for the user-facing value.
optionsEnum :: (MonadHandler m, Show a, Enum a, Bounded a) =&gt; m (OptionList a)
optionsEnum = optionsPairs $ map (\x -&gt; (pack $ show x, x)) [minBound..maxBound]

-- | Selects a list of 'Entity's with the given 'Filter' and 'SelectOpt's. The @(a -&gt; msg)@ function is then used to derive the display value for an 'OptionList'. Example usage:
--
-- &gt; Country
-- &gt;    name Text
-- &gt;    deriving Eq -- Must derive Eq
--
-- &gt; data CountryForm = CountryForm
-- &gt;   { country :: Entity Country
-- &gt;   }
-- &gt;
-- &gt; countryNameForm :: AForm Handler CountryForm
-- &gt; countryNameForm = CountryForm
-- &gt;         &lt;$&gt; areq (selectField countries) &quot;Which country do you live in?&quot; Nothing
-- &gt;         where
-- &gt;           countries = optionsPersist [] [Asc CountryName] countryName
#if MIN_VERSION_persistent(2,5,0)
optionsPersist :: ( YesodPersist site
                  , PersistQueryRead backend
                  , PathPiece (Key a)
                  , RenderMessage site msg
                  , YesodPersistBackend site ~ backend
                  , PersistRecordBackend a backend
                  )
               =&gt; [Filter a]
               -&gt; [SelectOpt a]
               -&gt; (a -&gt; msg)
               -&gt; HandlerT site IO (OptionList (Entity a))
#else
optionsPersist :: ( YesodPersist site, PersistEntity a
                  , PersistQuery (PersistEntityBackend a)
                  , PathPiece (Key a)
                  , RenderMessage site msg
                  , YesodPersistBackend site ~ PersistEntityBackend a
                  )
               =&gt; [Filter a]
               -&gt; [SelectOpt a]
               -&gt; (a -&gt; msg)
               -&gt; HandlerT site IO (OptionList (Entity a))
#endif
optionsPersist filts ords toDisplay = fmap mkOptionList $ do
    mr &lt;- getMessageRender
    pairs &lt;- runDB $ selectList filts ords
    return $ map (\(Entity key value) -&gt; Option
        { optionDisplay = mr (toDisplay value)
        , optionInternalValue = Entity key value
        , optionExternalValue = toPathPiece key
        }) pairs

-- | An alternative to 'optionsPersist' which returns just the 'Key' instead of
-- the entire 'Entity'.
--
-- Since 1.3.2
#if MIN_VERSION_persistent(2,5,0)
optionsPersistKey
  :: (YesodPersist site
     , PersistQueryRead backend
     , PathPiece (Key a)
     , RenderMessage site msg
     , backend ~ YesodPersistBackend site
     , PersistRecordBackend a backend
     )
  =&gt; [Filter a]
  -&gt; [SelectOpt a]
  -&gt; (a -&gt; msg)
  -&gt; HandlerT site IO (OptionList (Key a))
#else
optionsPersistKey
  :: (YesodPersist site
     , PersistEntity a
     , PersistQuery (PersistEntityBackend a)
     , PathPiece (Key a)
     , RenderMessage site msg
     , YesodPersistBackend site ~ PersistEntityBackend a
     )
  =&gt; [Filter a]
  -&gt; [SelectOpt a]
  -&gt; (a -&gt; msg)
  -&gt; HandlerT site IO (OptionList (Key a))
#endif

optionsPersistKey filts ords toDisplay = fmap mkOptionList $ do
    mr &lt;- getMessageRender
    pairs &lt;- runDB $ selectList filts ords
    return $ map (\(Entity key value) -&gt; Option
        { optionDisplay = mr (toDisplay value)
        , optionInternalValue = key
        , optionExternalValue = toPathPiece key
        }) pairs

selectFieldHelper
        :: (Eq a, RenderMessage site FormMessage)
        =&gt; (Text -&gt; Text -&gt; [(Text, Text)] -&gt; WidgetT site IO () -&gt; WidgetT site IO ())
        -&gt; (Text -&gt; Text -&gt; Bool -&gt; WidgetT site IO ())
        -&gt; (Text -&gt; Text -&gt; [(Text, Text)] -&gt; Text -&gt; Bool -&gt; Text -&gt; WidgetT site IO ())
        -&gt; HandlerT site IO (OptionList a)
        -&gt; Field (HandlerT site IO) a
selectFieldHelper outside onOpt inside opts' = Field
    { fieldParse = \x _ -&gt; do
        opts &lt;- opts'
        return $ selectParser opts x
    , fieldView = \theId name attrs val isReq -&gt; do
        opts &lt;- fmap olOptions $ handlerToWidget opts'
        outside theId name attrs $ do
            unless isReq $ onOpt theId name $ not $ render opts val `elem` map optionExternalValue opts
            flip mapM_ opts $ \opt -&gt; inside
                theId
                name
                ((if isReq then ((&quot;required&quot;, &quot;required&quot;):) else id) attrs)
                (optionExternalValue opt)
                ((render opts val) == optionExternalValue opt)
                (optionDisplay opt)
    , fieldEnctype = UrlEncoded
    }
  where
    render _ (Left _) = &quot;&quot;
    render opts (Right a) = maybe &quot;&quot; optionExternalValue $ listToMaybe $ filter ((== a) . optionInternalValue) opts
    selectParser _ [] = Right Nothing
    selectParser opts (s:_) = case s of
            &quot;&quot; -&gt; Right Nothing
            &quot;none&quot; -&gt; Right Nothing
            x -&gt; case olReadExternal opts x of
                    Nothing -&gt; Left $ SomeMessage $ MsgInvalidEntry x
                    Just y -&gt; Right $ Just y

-- | Creates an input with @type=&quot;file&quot;@.
fileField :: Monad m
          =&gt; Field m FileInfo
fileField = Field
    { fieldParse = \_ files -&gt; return $
        case files of
            [] -&gt; Right Nothing
            file:_ -&gt; Right $ Just file
    , fieldView = \id' name attrs _ isReq -&gt; toWidget [hamlet|
            &lt;input id=#{id'} name=#{name} *{attrs} type=file :isReq:required&gt;
        |]
    , fieldEnctype = Multipart
    }

fileAFormReq :: (MonadHandler m, RenderMessage (HandlerSite m) FormMessage)
             =&gt; FieldSettings (HandlerSite m) -&gt; AForm m FileInfo
fileAFormReq fs = AForm $ \(site, langs) menvs ints -&gt; do
    let (name, ints') =
            case fsName fs of
                Just x -&gt; (x, ints)
                Nothing -&gt;
                    let i' = incrInts ints
                     in (pack $ 'f' : show i', i')
    id' &lt;- maybe newIdent return $ fsId fs
    let (res, errs) =
            case menvs of
                Nothing -&gt; (FormMissing, Nothing)
                Just (_, fenv) -&gt;
                    case Map.lookup name fenv of
                        Just (fi:_) -&gt; (FormSuccess fi, Nothing)
                        _ -&gt;
                            let t = renderMessage site langs MsgValueRequired
                             in (FormFailure [t], Just $ toHtml t)
    let fv = FieldView
            { fvLabel = toHtml $ renderMessage site langs $ fsLabel fs
            , fvTooltip = fmap (toHtml . renderMessage site langs) $ fsTooltip fs
            , fvId = id'
            , fvInput = [whamlet|
$newline never
&lt;input type=file name=#{name} ##{id'} *{fsAttrs fs}&gt;
|]
            , fvErrors = errs
            , fvRequired = True
            }
    return (res, (fv :), ints', Multipart)

fileAFormOpt :: MonadHandler m
             =&gt; FieldSettings (HandlerSite m)
             -&gt; AForm m (Maybe FileInfo)
fileAFormOpt fs = AForm $ \(master, langs) menvs ints -&gt; do
    let (name, ints') =
            case fsName fs of
                Just x -&gt; (x, ints)
                Nothing -&gt;
                    let i' = incrInts ints
                     in (pack $ 'f' : show i', i')
    id' &lt;- maybe newIdent return $ fsId fs
    let (res, errs) =
            case menvs of
                Nothing -&gt; (FormMissing, Nothing)
                Just (_, fenv) -&gt;
                    case Map.lookup name fenv of
                        Just (fi:_) -&gt; (FormSuccess $ Just fi, Nothing)
                        _ -&gt; (FormSuccess Nothing, Nothing)
    let fv = FieldView
            { fvLabel = toHtml $ renderMessage master langs $ fsLabel fs
            , fvTooltip = fmap (toHtml . renderMessage master langs) $ fsTooltip fs
            , fvId = id'
            , fvInput = [whamlet|
$newline never
&lt;input type=file name=#{name} ##{id'} *{fsAttrs fs}&gt;
|]
            , fvErrors = errs
            , fvRequired = False
            }
    return (res, (fv :), ints', Multipart)

incrInts :: Ints -&gt; Ints
incrInts (IntSingle i) = IntSingle $ i + 1
incrInts (IntCons i is) = (i + 1) `IntCons` is


-- | Adds a '0' to some text so that it may be recognized as a double.
--   The read ftn does not recognize &quot;.3&quot; as 0.3 nor &quot;-.3&quot; as -0.3, so this
--   function changes &quot;.xxx&quot; to &quot;0.xxx&quot; and &quot;-.xxx&quot; to &quot;-0.xxx&quot;

prependZero :: Text -&gt; Text
prependZero t0 = if T.null t1
                 then t1
                 else if T.head t1 == '.'
                      then '0' `T.cons` t1
                      else if &quot;-.&quot; `T.isPrefixOf` t1
                           then &quot;-0.&quot; `T.append` (T.drop 2 t1)
                           else t1

  where t1 = T.dropWhile ((==) ' ') t0

-- $optionsOverview
-- These functions create inputs where one or more options can be selected from a list.
-- 
-- The basic datastructure used is an 'Option', which combines a user-facing display value, the internal Haskell value being selected, and an external 'Text' stored as the @value@ in the form (used to map back to the internal value). A list of these, together with a function mapping from an external value back to a Haskell value, form an 'OptionList', which several of these functions take as an argument.
-- 
-- Typically, you won't need to create an 'OptionList' directly and can instead make one with functions like 'optionsPairs' or 'optionsEnum'. Alternatively, you can use functions like 'selectFieldList', which use their @[(msg, a)]@ parameter to create an 'OptionList' themselves.
</span></pre></body></html>